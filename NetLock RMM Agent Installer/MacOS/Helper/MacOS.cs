using Helper;
using MacOS.Helper;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace NetLock_RMM_Agent_Installer.MacOS.Helper
{
    internal class MacOS
    {
        public static void CreateMacServiceFile()
        {
            string comm_agent_script = "IyEvYmluL2Jhc2gNCiMgTmV0TG9jayBSTU0gQWdlbnQgQ29tbSBJbnN0YWxsYXRpb24gU2NyaXB0DQoNClBMSVNUX1BBVEg9Ii9MaWJyYXJ5L0xhdW5jaERhZW1vbnMvY29tLm5ldGxvY2sucm1tLmFnZW50Y29tbS5wbGlzdCINCkVYRUNVVEFCTEU9Ii91c3IvbG9jYWwvYmluLzB4MTAxX0N5YmVyX1NlY3VyaXR5L05ldExvY2tfUk1NL0NvbW1fQWdlbnQvTmV0TG9ja19STU1fQWdlbnRfQ29tbSINCkxPR19QQVRIPSIvdmFyL2xvZy9uZXRsb2NrX3JtbV9hZ2VudGNvbW0ubG9nIg0KRVJST1JfTE9HX1BBVEg9Ii92YXIvbG9nL25ldGxvY2tfcm1tX2FnZW50Y29tbV9lcnJvci5sb2ciDQoNCiMgUHLDvGZlbiwgb2IgZGFzIFNrcmlwdCBtaXQgUm9vdC1SZWNodGVuIGF1c2dlZsO8aHJ0IHdpcmQNCmlmIFtbICRFVUlEIC1uZSAwIF1dOyB0aGVuDQogICBlY2hvICJUaGlzIHNjcmlwdCBtdXN0IGJlIGV4ZWN1dGVkIGFzIHJvb3QhIChzdWRvICQwKSINCiAgIGV4aXQgMQ0KZmkNCg0KIyAxLiBQbGlzdC1EYXRlaSBlcnN0ZWxsZW4NCmVjaG8gIkNyZWF0ZSBMYXVuY2hEYWVtb24tUGxpc3QgdW5kZXIgJFBMSVNUX1BBVEggLi4uIg0KY2F0IDw8RU9GID4gIiRQTElTVF9QQVRIIg0KPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjwhRE9DVFlQRSBwbGlzdCBQVUJMSUMgIi0vL0FwcGxlLy9EVEQgUExJU1QgMS4wLy9FTiIgImh0dHA6Ly93d3cuYXBwbGUuY29tL0RURHMvUHJvcGVydHlMaXN0LTEuMC5kdGQiPg0KPHBsaXN0IHZlcnNpb249IjEuMCI+DQogIDxkaWN0Pg0KICAgIDxrZXk+TGFiZWw8L2tleT4NCiAgICA8c3RyaW5nPmNvbS5uZXRsb2NrLnJtbS5hZ2VudGNvbW08L3N0cmluZz4NCg0KICAgIDxrZXk+UHJvZ3JhbUFyZ3VtZW50czwva2V5Pg0KICAgIDxhcnJheT4NCiAgICAgIDxzdHJpbmc+JEVYRUNVVEFCTEU8L3N0cmluZz4NCiAgICA8L2FycmF5Pg0KDQogICAgPGtleT5SdW5BdExvYWQ8L2tleT4NCiAgICA8dHJ1ZS8+DQoNCiAgICA8a2V5PktlZXBBbGl2ZTwva2V5Pg0KICAgIDx0cnVlLz4NCg0KICAgIDxrZXk+U3RhbmRhcmRPdXRQYXRoPC9rZXk+DQogICAgPHN0cmluZz4kTE9HX1BBVEg8L3N0cmluZz4NCg0KICAgIDxrZXk+U3RhbmRhcmRFcnJvclBhdGg8L2tleT4NCiAgICA8c3RyaW5nPiRFUlJPUl9MT0dfUEFUSDwvc3RyaW5nPg0KICA8L2RpY3Q+DQo8L3BsaXN0Pg0KRU9GDQoNCiMgMi4gU2V0IHRoZSBjb3JyZWN0IGF1dGhvcmlzYXRpb25zDQplY2hvICJTZXQgYXV0aG9yaXNhdGlvbnMgZm9yIHRoZSBwbGlzdCBmaWxlIC4uLiINCmNobW9kIDY0NCAiJFBMSVNUX1BBVEgiDQpjaG93biByb290OndoZWVsICIkUExJU1RfUEFUSCINCg0KIyAzLiBFbnN1cmUgdGhhdCB0aGUgZXhlY3V0YWJsZSBmaWxlIGV4aXN0cyBhbmQgaXMgZXhlY3V0YWJsZQ0KaWYgW1sgLWYgIiRFWEVDVVRBQkxFIiBdXTsgdGhlbg0KICAgIGVjaG8gIlNldCBwZXJtaXNzaW9ucyBmb3IgdGhlIGV4ZWN1dGFibGUgZmlsZSAuLi4iDQogICAgY2htb2QgK3ggIiRFWEVDVVRBQkxFIg0KZWxzZQ0KICAgIGVjaG8gIldBUk5JTkc6IFRoZSBleGVjdXRhYmxlIGZpbGUgJEVYRUNVVEFCTEUgZG9lcyBub3QgZXhpc3QhIg0KZmkNCg0KIyA0LiBMb2FkIGFuZCBzdGFydCBzZXJ2aWNlDQplY2hvICJMb2FkIGFuZCBzdGFydCB0aGUgc2VydmljZSAuLi4iDQpsYXVuY2hjdGwgbG9hZCAiJFBMSVNUX1BBVEgiDQoNCmVjaG8gIlNldHVwIGNvbXBsZXRlZC4gU2VydmljZSBzdGF0dXM6Ig0KbGF1bmNoY3RsIGxpc3QgfCBncmVwIGNvbS5uZXRsb2NrLnJtbS5hZ2VudGNvbW0NCg==";
            string remote_agent_script = "IyEvYmluL2Jhc2gNCiMgTmV0TG9jayBSTU0gQWdlbnQgUmVtb3RlIEluc3RhbGxhdGlvbiBTY3JpcHQNCg0KUExJU1RfUEFUSD0iL0xpYnJhcnkvTGF1bmNoRGFlbW9ucy9jb20ubmV0bG9jay5ybW0uYWdlbnRyZW1vdGUucGxpc3QiDQpFWEVDVVRBQkxFPSIvdXNyL2xvY2FsL2Jpbi8weDEwMV9DeWJlcl9TZWN1cml0eS9OZXRMb2NrX1JNTS9SZW1vdGVfQWdlbnQvTmV0TG9ja19STU1fQWdlbnRfUmVtb3RlIg0KTE9HX1BBVEg9Ii92YXIvbG9nL25ldGxvY2tfcm1tX2FnZW50cmVtb3RlLmxvZyINCkVSUk9SX0xPR19QQVRIPSIvdmFyL2xvZy9uZXRsb2NrX3JtbV9hZ2VudHJlbW90ZV9lcnJvci5sb2ciDQoNCiMgUHLDvGZlbiwgb2IgZGFzIFNrcmlwdCBtaXQgUm9vdC1SZWNodGVuIGF1c2dlZsO8aHJ0IHdpcmQNCmlmIFtbICRFVUlEIC1uZSAwIF1dOyB0aGVuDQogICBlY2hvICJUaGlzIHNjcmlwdCBtdXN0IGJlIGV4ZWN1dGVkIGFzIHJvb3QhIChzdWRvICQwKSINCiAgIGV4aXQgMQ0KZmkNCg0KIyAxLiBQbGlzdC1EYXRlaSBlcnN0ZWxsZW4NCmVjaG8gIkNyZWF0ZSBMYXVuY2hEYWVtb24tUGxpc3QgdW5kZXIgJFBMSVNUX1BBVEggLi4uIg0KY2F0IDw8RU9GID4gIiRQTElTVF9QQVRIIg0KPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjwhRE9DVFlQRSBwbGlzdCBQVUJMSUMgIi0vL0FwcGxlLy9EVEQgUExJU1QgMS4wLy9FTiIgImh0dHA6Ly93d3cuYXBwbGUuY29tL0RURHMvUHJvcGVydHlMaXN0LTEuMC5kdGQiPg0KPHBsaXN0IHZlcnNpb249IjEuMCI+DQogIDxkaWN0Pg0KICAgIDxrZXk+TGFiZWw8L2tleT4NCiAgICA8c3RyaW5nPmNvbS5uZXRsb2NrLnJtbS5hZ2VudHJlbW90ZTwvc3RyaW5nPg0KDQogICAgPGtleT5Qcm9ncmFtQXJndW1lbnRzPC9rZXk+DQogICAgPGFycmF5Pg0KICAgICAgPHN0cmluZz4kRVhFQ1VUQUJMRTwvc3RyaW5nPg0KICAgIDwvYXJyYXk+DQoNCiAgICA8a2V5PlJ1bkF0TG9hZDwva2V5Pg0KICAgIDx0cnVlLz4NCg0KICAgIDxrZXk+S2VlcEFsaXZlPC9rZXk+DQogICAgPHRydWUvPg0KDQogICAgPGtleT5TdGFuZGFyZE91dFBhdGg8L2tleT4NCiAgICA8c3RyaW5nPiRMT0dfUEFUSDwvc3RyaW5nPg0KDQogICAgPGtleT5TdGFuZGFyZEVycm9yUGF0aDwva2V5Pg0KICAgIDxzdHJpbmc+JEVSUk9SX0xPR19QQVRIPC9zdHJpbmc+DQogIDwvZGljdD4NCjwvcGxpc3Q+DQpFT0YNCg0KIyAyLiBTZXQgdGhlIGNvcnJlY3QgYXV0aG9yaXNhdGlvbnMNCmVjaG8gIlNldCBhdXRob3Jpc2F0aW9ucyBmb3IgdGhlIHBsaXN0IGZpbGUgLi4uIg0KY2htb2QgNjQ0ICIkUExJU1RfUEFUSCINCmNob3duIHJvb3Q6d2hlZWwgIiRQTElTVF9QQVRIIg0KDQojIDMuIEVuc3VyZSB0aGF0IHRoZSBleGVjdXRhYmxlIGZpbGUgZXhpc3RzIGFuZCBpcyBleGVjdXRhYmxlDQppZiBbWyAtZiAiJEVYRUNVVEFCTEUiIF1dOyB0aGVuDQogICAgZWNobyAiU2V0IHBlcm1pc3Npb25zIGZvciB0aGUgZXhlY3V0YWJsZSBmaWxlIC4uLiINCiAgICBjaG1vZCAreCAiJEVYRUNVVEFCTEUiDQplbHNlDQogICAgZWNobyAiV0FSTklORzogVGhlIGV4ZWN1dGFibGUgZmlsZSAkRVhFQ1VUQUJMRSBkb2VzIG5vdCBleGlzdCEiDQpmaQ0KDQojIDQuIExvYWQgYW5kIHN0YXJ0IHNlcnZpY2UNCmVjaG8gIkxvYWQgYW5kIHN0YXJ0IHRoZSBzZXJ2aWNlIC4uLiINCmxhdW5jaGN0bCBsb2FkICIkUExJU1RfUEFUSCINCg0KZWNobyAiU2V0dXAgY29tcGxldGVkLiBTZXJ2aWNlIHN0YXR1czoiDQpsYXVuY2hjdGwgbGlzdCB8IGdyZXAgY29tLm5ldGxvY2sucm1tLmFnZW50cmVtb3RlDQo=";
            string health_agent_script = "IyEvYmluL2Jhc2gNCiMgTmV0TG9jayBSTU0gQWdlbnQgQ29tbSBJbnN0YWxsYXRpb24gU2NyaXB0DQoNClBMSVNUX1BBVEg9Ii9MaWJyYXJ5L0xhdW5jaERhZW1vbnMvY29tLm5ldGxvY2sucm1tLmFnZW50aGVhbHRoLnBsaXN0Ig0KRVhFQ1VUQUJMRT0iL3Vzci9sb2NhbC9iaW4vMHgxMDFfQ3liZXJfU2VjdXJpdHkvTmV0TG9ja19STU0vSGVhbHRoX0FnZW50L05ldExvY2tfUk1NX0FnZW50X0hlYWx0aCINCkxPR19QQVRIPSIvdmFyL2xvZy9uZXRsb2NrX3JtbV9hZ2VudGhlYWx0aC5sb2ciDQpFUlJPUl9MT0dfUEFUSD0iL3Zhci9sb2cvbmV0bG9ja19ybW1fYWdlbnRoZWFsdGhfZXJyb3IubG9nIg0KDQojIFByw7xmZW4sIG9iIGRhcyBTa3JpcHQgbWl0IFJvb3QtUmVjaHRlbiBhdXNnZWbDvGhydCB3aXJkDQppZiBbWyAkRVVJRCAtbmUgMCBdXTsgdGhlbg0KICAgZWNobyAiVGhpcyBzY3JpcHQgbXVzdCBiZSBleGVjdXRlZCBhcyByb290ISAoc3VkbyAkMCkiDQogICBleGl0IDENCmZpDQoNCiMgMS4gUGxpc3QtRGF0ZWkgZXJzdGVsbGVuDQplY2hvICJDcmVhdGUgTGF1bmNoRGFlbW9uLVBsaXN0IHVuZGVyICRQTElTVF9QQVRIIC4uLiINCmNhdCA8PEVPRiA+ICIkUExJU1RfUEFUSCINCjw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+DQo8IURPQ1RZUEUgcGxpc3QgUFVCTElDICItLy9BcHBsZS8vRFREIFBMSVNUIDEuMC8vRU4iICJodHRwOi8vd3d3LmFwcGxlLmNvbS9EVERzL1Byb3BlcnR5TGlzdC0xLjAuZHRkIj4NCjxwbGlzdCB2ZXJzaW9uPSIxLjAiPg0KICA8ZGljdD4NCiAgICA8a2V5PkxhYmVsPC9rZXk+DQogICAgPHN0cmluZz5jb20ubmV0bG9jay5ybW0uYWdlbnRoZWFsdGg8L3N0cmluZz4NCg0KICAgIDxrZXk+UHJvZ3JhbUFyZ3VtZW50czwva2V5Pg0KICAgIDxhcnJheT4NCiAgICAgIDxzdHJpbmc+JEVYRUNVVEFCTEU8L3N0cmluZz4NCiAgICA8L2FycmF5Pg0KDQogICAgPGtleT5SdW5BdExvYWQ8L2tleT4NCiAgICA8dHJ1ZS8+DQoNCiAgICA8a2V5PktlZXBBbGl2ZTwva2V5Pg0KICAgIDx0cnVlLz4NCg0KICAgIDxrZXk+U3RhbmRhcmRPdXRQYXRoPC9rZXk+DQogICAgPHN0cmluZz4kTE9HX1BBVEg8L3N0cmluZz4NCg0KICAgIDxrZXk+U3RhbmRhcmRFcnJvclBhdGg8L2tleT4NCiAgICA8c3RyaW5nPiRFUlJPUl9MT0dfUEFUSDwvc3RyaW5nPg0KICA8L2RpY3Q+DQo8L3BsaXN0Pg0KRU9GDQoNCiMgMi4gU2V0IHRoZSBjb3JyZWN0IGF1dGhvcmlzYXRpb25zDQplY2hvICJTZXQgYXV0aG9yaXNhdGlvbnMgZm9yIHRoZSBwbGlzdCBmaWxlIC4uLiINCmNobW9kIDY0NCAiJFBMSVNUX1BBVEgiDQpjaG93biByb290OndoZWVsICIkUExJU1RfUEFUSCINCg0KIyAzLiBFbnN1cmUgdGhhdCB0aGUgZXhlY3V0YWJsZSBmaWxlIGV4aXN0cyBhbmQgaXMgZXhlY3V0YWJsZQ0KaWYgW1sgLWYgIiRFWEVDVVRBQkxFIiBdXTsgdGhlbg0KICAgIGVjaG8gIlNldCBwZXJtaXNzaW9ucyBmb3IgdGhlIGV4ZWN1dGFibGUgZmlsZSAuLi4iDQogICAgY2htb2QgK3ggIiRFWEVDVVRBQkxFIg0KZWxzZQ0KICAgIGVjaG8gIldBUk5JTkc6IFRoZSBleGVjdXRhYmxlIGZpbGUgJEVYRUNVVEFCTEUgZG9lcyBub3QgZXhpc3QhIg0KZmkNCg0KIyA0LiBMb2FkIGFuZCBzdGFydCBzZXJ2aWNlDQplY2hvICJMb2FkIGFuZCBzdGFydCB0aGUgc2VydmljZSAuLi4iDQpsYXVuY2hjdGwgbG9hZCAiJFBMSVNUX1BBVEgiDQoNCmVjaG8gIlNldHVwIGNvbXBsZXRlZC4gU2VydmljZSBzdGF0dXM6Ig0KbGF1bmNoY3RsIGxpc3QgfCBncmVwIGNvbS5uZXRsb2NrLnJtbS5hZ2VudGhlYWx0aA0K";

            // Execute the scripts
            string comm_agent_script_output = Zsh.Execute_Script("CommAgent", true, comm_agent_script);
            Logging.Handler.Debug("MacOS.Helper.MacOS.CreateMacServiceFile", "CommAgent script output", comm_agent_script_output);
            Console.WriteLine(comm_agent_script_output);

            string remote_agent_script_output = Zsh.Execute_Script("RemoteAgent", true, remote_agent_script);
            Logging.Handler.Debug("MacOS.Helper.MacOS.CreateMacServiceFile", "RemoteAgent script output", remote_agent_script_output);
            Console.WriteLine(remote_agent_script_output);

            string health_agent_script_output = Zsh.Execute_Script("HealthAgent", true, health_agent_script);
            Logging.Handler.Debug("MacOS.Helper.MacOS.CreateMacServiceFile", "HealthAgent script output", health_agent_script_output);
            Console.WriteLine(health_agent_script_output);
        }
    }
}
