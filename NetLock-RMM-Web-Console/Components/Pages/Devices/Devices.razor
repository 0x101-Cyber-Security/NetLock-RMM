@page "/devices"
@using MySqlConnector
@using System.Data.Common
@using System.Text.Json
@using System.Xml.Serialization
@using System.Text
@using System.Text.RegularExpressions
@using System.Text.Json.Nodes
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@using Microsoft.AspNetCore.DataProtection
@using System.Globalization
@using Microsoft.AspNetCore.SignalR.Client
@using System.Net.Http
@using System.Security.Claims

@inject NavigationManager NavigationManager
@inject ILocalStorageService localStorage
@inject IDialogService DialogService
@inject ISnackbar Snackbar
@inject IJSRuntime JSRuntime
@inject IDataProtectionProvider DataProtectionProvider
@inject IStringLocalizer<Pages.Devices.Devices> Localizer
@inject AuthenticationStateProvider AuthenticationStateProvider

<style>
    .selected-row-light {
        background-color: lightgray;
    }

    .selected-row-dark {
        background-color: #141414;
    }

    .custom-expansion-panel {
        background-color: transparent;
    }

    .dialog-blurring {
        backdrop-filter: blur(10px);
    }

    .mud-table-cell-custom-group {
        font-weight: 500;
    }

    .mud-table-cell-custom-group-footer {
        padding-bottom: 50px;
        text-align: right;
    }
    
    @@media only screen and (max-width: 768px) {
        .desktop-icon {
            display: none;
        }
    }

    @@keyframes fadeIn {
        from {opacity: 0;}
        to {opacity: 1;}
    }

    .animated-text {
        animation: pulse 2s infinite ease-in-out;
    }

    @@keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.6; }
    }

    .wave-emoji {
        display: inline-block;
        animation: wave 2s infinite;
        transform-origin: 70% 70%;
    }

    @@keyframes wave {
        0% { transform: rotate(0deg); }
        15% { transform: rotate(15deg); }
        30% { transform: rotate(-10deg); }
        45% { transform: rotate(15deg); }
        60% { transform: rotate(-10deg); }
        75% { transform: rotate(15deg); }
        100% { transform: rotate(0deg); }
    }

</style>


<MudOverlay Visible="@loading_overlay" DarkBackground="false" Absolute="false">
    <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; gap: 1rem; animation: fadeIn 0.5s ease-in-out;">
        <MudProgressCircular Color="Color.Primary" Size="Size.Large" Indeterminate="true" Thickness="6" />
        <MudText Typo="Typo.h5" Class="animated-text">
            Please wait... <span class="wave-emoji">🐧</span>
        </MudText>
    </div>
</MudOverlay>


<AuthorizeView>

    <Authorized>
        @{
            if (permissions_devices_authorized_enabled)
            {
                <MudText Typo="Typo.h5">@Localizer["authorized_devices"]</MudText>
                <MudText Typo="Typo.h6">@group_name_displayed</MudText>
            
                if (group_name != Localizer["all_devices"] && permissions_devices_move)
                {                            
                    <MudButton Class="mt-2" Size="Size.Small" Variant="Variant.Filled" Color="Color.Default" StartIcon="@Icons.Material.Filled.MoveDown" OnClick="Move_Devices_Dialog">@Localizer["move_devices"]</MudButton>
                }   

                    <MudTooltip Text="@Localizer["refresh"]">
                        <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.Refresh" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="async () => { await AfterInitializedAsync(); }"></MudIconButton>
                    </MudTooltip>

                    <MudTooltip Text="@Localizer["export_data"]">
                        <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Device_Table_Dialog"></MudIconButton>
                    </MudTooltip>

                    if (remote_server_client_setup)
                    {
                        <MudTooltip Text="You are connected to the remote backend.">
                            <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.PrivateConnectivity" Variant="Variant.Filled" Size="Size.Small" Color="Color.Success"></MudIconButton>
                        </MudTooltip>
                    }
                    else
                    {
                        <MudTooltip Text="You are not connected to the remote backend. Remote tasks are not available. Check your configuration.">
                            <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.CrisisAlert" Variant="Variant.Filled" Size="Size.Small" Color="Color.Error"></MudIconButton>
                        </MudTooltip>
                    } 

                    <MudTable Class="mt-5" Height="@(devices_table_view_port)" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@mysql_data" Filter="new Func<MySQL_Entity, bool>(Devices_Table_Filter_Func)">
                        <ToolBarContent>
                            <MudTextField @bind-Value="device_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                        </ToolBarContent>
                        <HeaderContent>
                                    <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.device_name)">Name</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.tenant_name)">@Localizer["tenant"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.location_name)">@Localizer["location"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.group_name)">@Localizer["group"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.agent_version)">@Localizer["agent_version"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.last_access)">@Localizer["last_access"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.ip_address)">@Localizer["ip_address"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.operating_system)">@Localizer["os"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.domain)">@Localizer["domain"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.last_active_user)">Last active user</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.firewall_status)">@Localizer["firewall"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.antivirus_solution)">@Localizer["antivirus_solution"]</MudTableSortLabel></MudTh>
                            <MudTh style="white-space: nowrap;">
                                <MudTableSortLabel SortBy="new Func<MySQL_Entity, object>(x => x.uptime_monitoring_enabled)">
                                    @Localizer["uptime_monitoring"]
                                </MudTableSortLabel>
                            </MudTh>                        </HeaderContent>
                    <RowTemplate Context="row">

                        @{
                            DateTime lastAccess;
                            var isValidDate = DateTime.TryParse(row.last_access, out lastAccess);
                            var isOlderThan10Minutes = isValidDate && (DateTime.UtcNow - lastAccess).TotalMinutes > 10;
                            var iconColor = isValidDate && (DateTime.UtcNow - lastAccess).TotalMinutes > 10 ? "color: grey;" : "color: green;";
                        }

                        @if (row.platform == "Windows")
                        {
                                <MudTd DataLabel="Name" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                    <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Custom.Brands.MicrosoftWindows" Size="Size.Small" class="desktop-icon" Style="@(iconColor)" />&nbsp;@row.device_name
                                    </span>
                                </MudTd>
                        }
                        else if (row.platform == "Linux")
                        {
                                <MudTd DataLabel="Name" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                    <span style="display: flex; align-items: center;">
                                        <MudIcon Icon="@Icons.Custom.Brands.Linux" Size="Size.Small" class="desktop-icon" Style="@(iconColor)" />&nbsp;@row.device_name
                                    </span>
                                </MudTd>
                        }
                        else if (row.platform == "MacOS")
                        {
                                <MudTd DataLabel="Name" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                    <span style="display: flex; align-items: center;">
                                        <MudIcon Icon="@Icons.Custom.Brands.Apple" Size="Size.Small" class="desktop-icon" Style="@(iconColor)" />&nbsp;@row.device_name
                                    </span>
                                </MudTd>
                        }



                                            <MudTd DataLabel="@Localizer["tenant"]" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.Person" Size="Size.Small" class="desktop-icon" />&nbsp;@row.tenant_name
                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="@Localizer["location"]" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.LocationCity" Size="Size.Small" class="desktop-icon" />&nbsp;@row.location_name
                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="@Localizer["group"]" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.Group" Size="Size.Small" class="desktop-icon" />&nbsp;@row.group_name
                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="@Localizer["agent_version"]" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.Update" Size="Size.Small" class="desktop-icon" />&nbsp;@row.agent_version
                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="@Localizer["last_access"]" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.AccessTime" Size="Size.Small" class="desktop-icon" />&nbsp;@row.last_access
                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="IP address" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.NetworkWifi1Bar" Size="Size.Small" class="desktop-icon" />&nbsp;@row.ip_address
                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="@Localizer["os"]" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.DeveloperBoard" Size="Size.Small" class="desktop-icon" />&nbsp;@row.operating_system
                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="@Localizer["domain"]" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.Domain" Size="Size.Small" class="desktop-icon" />&nbsp;@row.domain
                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="Last active user" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.People" Size="Size.Small" class="desktop-icon" />&nbsp;@row.last_active_user
                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="@Localizer["firewall"]" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">

                                @if (row.platform == "Windows" || row.platform == "Linux" || row.platform == "MacOS")
                                {
                                    @if (row.firewall_status == "True")
                                    {
                                                                        <MudIcon Icon="@Icons.Material.Filled.Fireplace" Color="Color.Success" Size="Size.Small" class="desktop-icon" />

                                                            <span>&nbsp;</span>

                                        @Localizer["enabled"]
                                    }
                                    else
                                    {
                                                                        <MudIcon Icon="@Icons.Material.Filled.Fireplace" Color="Color.Warning" Size="Size.Small" class="desktop-icon" />

                                                            <span>&nbsp;</span>

                                        @Localizer["disabled"]
                                    }
                                }
                                else
                                {
                                                            <MudIcon Icon="@Icons.Material.Filled.Fireplace" Color="Color.Default" Size="Size.Small" class="desktop-icon" />

                                                    <span>&nbsp; -</span>
                                }

                                                </span>
                                            </MudTd>

                                            <MudTd DataLabel="@Localizer["antivirus_solution"]" @onclick="() => Devices_RowClickHandler(row)" class="@Devices_GetRowClass(row)" style="white-space: nowrap;">
                                                <span style="display: flex; align-items: center;">
                                                    <MudIcon Icon="@Icons.Material.Filled.Coronavirus" Size="Size.Small" class="desktop-icon" />&nbsp;@row.antivirus_solution
                                                </span>
                                            </MudTd>

                                        <MudTd DataLabel="@Localizer["uptime_monitoring"]" style="white-space: nowrap;">
                                            <span style="display: flex; justify-content: center; align-items: center; height: 100%;">
                                                <MudCheckBox T="bool" @bind-Value="row.uptime_monitoring_enabled" @bind-Value:after="() => Devices_Uptime_Monitoring_RowClickHandler(row)" Color="Color.Primary" />
                                            </span>
                                        </MudTd>

                                        </RowTemplate>
                                            <PagerContent>
                                                <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                            </PagerContent>
                                    </MudTable>

                if (!disabled)
                {
                    <MudExpansionPanel Class="mt-5 custom-expansion-panel" @bind-Expanded="@expanded" @bind-Expanded:after="Device_Information_Expansion_Status"  Disabled="disabled" Text="@Localizer["information"]">
                        <TitleContent>
                            <div class="d-flex">
                                <MudIcon Icon="@Icons.Material.Filled.Info" class="mr-3"></MudIcon>
                                <MudText>@Localizer["device"] @Localizer["information"]</MudText>
                            </div>
                        </TitleContent>

                        <ChildContent>

                            <div class="d-flex flex-column flex-md-row align-items-center">
                                @if (permissions_devices_deauthorize)
                                {
                                    <MudButton Class="mb-2 mb-md-0 ml-0 ml-md-2" Size="Size.Small" Color="Color.Warning" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.DesktopAccessDisabled" @onclick="async () => { await Deauthorize_Device(notes_device_id); }">@Localizer["unauthorize"]</MudButton>

                                    @if (permissions_devices_move)
                                    {
                                        <MudButton Class="mb-2 mb-md-0 ml-0 ml-md-2" Size="Size.Small" Color="Color.Default" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.MoveDown" OnClick="Move_Device_Dialog">@Localizer["move"]</MudButton>
                                    }

                                    @if (permissions_devices_remote_shell)
                                    {
                                        <MudButton Class="mb-2 mb-md-0 ml-0 ml-md-2" Size="Size.Small" Color="Color.Default" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Terminal" OnClick="Remote_Shell_Dialog">Remote Shell</MudButton>
                                    }

                                    @if (permissions_devices_remote_file_browser)
                                    {
                                        <MudButton Class="mb-2 mb-md-0 ml-0 ml-md-2" Size="Size.Small" Color="Color.Default" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.FolderOpen" OnClick="Remote_File_Browser_Dialog">@Localizer["file_browser"]</MudButton>
                                    }

                                    @if (permissions_devices_remote_control && platform == "Windows")
                                    {
                                        <MudButton Class="mb-2 mb-md-0 ml-0 ml-md-2" Size="Size.Small" Color="Color.Default" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Monitor" OnClick="Remote_Control_Dialog">Remote Control</MudButton>
                                    }
                                }
                            </div>


                            <MudTabs KeepPanelsAlive=true Class="mt-2" Elevation="4" Rounded="false" Color="@Color.Default">
                                
                            @if (permissions_devices_general)
                            {
                                    <MudTabPanel Text="@Localizer["general"]">
                                        <MudPaper>
                                            <MudText Class="ml-2" Typo="Typo.h6">Agent</MudText>
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Update" Title="Status" Size="Size.Small" />&nbsp;Version: @agent_version</MudText>
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.AccessTime" Title="Status" Size="Size.Small" />&nbsp;@Localizer["last_access"]: @last_access</MudText>
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.NetworkWifi1Bar" Title="Status" Size="Size.Small" />&nbsp;@Localizer["external_ip"]: @ip_address_external</MudText>

                                            <MudText Class="mt-5 ml-2" Typo="Typo.h6">@Localizer["os"]</MudText>
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.DeveloperBoard" Title="Status" Size="Size.Small" />&nbsp;Edition: @operating_system</MudText>
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Domain" Title="Status" Size="Size.Small" />&nbsp;@Localizer["domain"]: @domain</MudText>
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Pages" Title="Status" Size="Size.Small" />&nbsp;@Localizer["architecture"]: @architecture</MudText>
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.People" Title="Status" Size="Size.Small" />&nbsp;Last active user: @last_active_user</MudText>

                                            <MudText Class="mt-5 ml-2" Typo="Typo.h6">@Localizer["security"]</MudText>

                                            @if (platform == "Windows" || platform == "Linux" || platform == "MacOS")
                                            {
                                                @if (firewall_status == "True")
                                                {
                                                    <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Fireplace" Title="Status" Color="Color.Success" Size="Size.Small" />&nbsp;Firewall: @Localizer["enabled"]</MudText>
                                                }
                                                else
                                                {
                                                    <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Fireplace" Title="Status"Color="Color.Warning" Size="Size.Small" />&nbsp;Firewall: @Localizer["disabled"]</MudText>
                                                }
                                            }
                                            else
                                            {
                                                <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Fireplace" Title="Status"Color="Color.Default" Size="Size.Small" />&nbsp;Firewall: -</MudText>
                                            }
                                            
                                          
                                                @if (platform == "Windows")
                                                {
                                                    <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Coronavirus" Title="Status" Size="Size.Small" />&nbsp;Antivirus: @antivirus_solution</MudText>
                                                }   
                                                <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.AvTimer" Title="Status" Size="Size.Small" />&nbsp;@Localizer["last_boot"]: @last_boot</MudText>
                                                <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Map" Title="Status" Size="Size.Small" />&nbsp;@Localizer["timezone"]: @timezone</MudText>

                                                <MudText Class="mt-5 ml-2" Typo="Typo.h6">Hardware</MudText>
                                                <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Stream" Title="Status" Size="Size.Small" />&nbsp;@Localizer["processor"]: @cpu</MudText>
                                                <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.DeveloperBoard" Title="Status" Size="Size.Small" />&nbsp;Mainboard: @mainboard</MudText>
                                                <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.SimCard" Title="Status" Size="Size.Small" />&nbsp;@Localizer["gpu"]: @gpu</MudText>
                                                <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Memory" Title="Status" Size="Size.Small" />&nbsp;@Localizer["ram"]: @ram (GB)</MudText>


                                            @{
                                                if (platform == "Windows")
                                                {
                                                    if (tpm == "True")
                                                    {
                                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.HeatPump" Title="Status" Size="Size.Small" />&nbsp;TPM: @Localizer["enabled"]</MudText>
                                                    }
                                                    else if (tpm == "False")
                                                    {
                                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.HeatPump" Title="Status" Size="Size.Small" />&nbsp;TPM: @Localizer["disabled"]</MudText>
                                                    }
                                                    else
                                                    {
                                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.HeatPump" Title="Status" Size="Size.Small" />&nbsp;TPM: @tpm</MudText>
                                                    }
                                                }
                                            }

                                            <MudExpansionPanel Class="mt-0 custom-expansion-panel" @bind-Expanded="device_information_general_history_expanded" @bind-Expanded:after="async () => { await Device_Information_General_History_Table_Submit_Picker(); }">
                                                <TitleContent>
                                                        <div class="d-flex">
                                                            <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                            <MudText>@Localizer["history"]</MudText>
                                                        </div>
                                                    </TitleContent>

                                                    <ChildContent>
                                                        <div style="display: flex; align-items: center;">
                                                            <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="device_information_general_history_table_picker" @bind-DateRange="device_information_general_history_table_dateRange">
                                                                <PickerActions Context="pickerActionsContext">
                                                                    <MudButton Class="mr-auto align-self-start" OnClick="@(() => device_information_general_history_table_picker.CloseAsync())">@Localizer["reset"]</MudButton>
                                                                    <MudButton OnClick="@(() => device_information_general_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                    <MudButton Color="Color.Primary" @onclick="async () => { await Device_Information_General_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                                </PickerActions>
                                                            </MudDateRangePicker>

                                                            <MudTooltip Text="@Localizer["export_data"]">
                                                                <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Device_History_Table_Dialog"></MudIconButton>
                                                            </MudTooltip>
                                                        </div>
                                                        <MudTable Class="mt-2" Height="25vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="50" Dense="true" Items="@device_information_general_history_mysql_data" Filter="new Func<Device_Information_General_History_Entity, bool>(Device_Information_General_History_Table_Filter_Func)">
                                                            <ToolBarContent>
                                                                <MudTextField @bind-Value="device_information_general_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                            </ToolBarContent>
                                                            <HeaderContent>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.date))" style="white-space: nowrap;">@Localizer["date"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.agent_version))" style="white-space: nowrap;">@Localizer["agent_version"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.operating_system))" style="white-space: nowrap;">@Localizer["os"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.domain))" style="white-space: nowrap;">@Localizer["domain"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.architecture))" style="white-space: nowrap;">@Localizer["architecture"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.antivirus_solution))" style="white-space: nowrap;">Antivirus</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.last_boot))" style="white-space: nowrap;">@Localizer["last_boot"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.timezone))" style="white-space: nowrap;">@Localizer["timezone"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.cpu))" style="white-space: nowrap;">@Localizer["processor"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.mainboard))" style="white-space: nowrap;">Mainboard</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.gpu))" style="white-space: nowrap;">@Localizer["gpu"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.ram))" style="white-space: nowrap;">@Localizer["ram"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.tpm))" style="white-space: nowrap;">TPM</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.ip_address_internal))" style="white-space: nowrap;">@Localizer["internal_ips"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.ip_address_external))" style="white-space: nowrap;">@Localizer["external_ip"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_general_history_table_sorted_column = (nameof(Device_Information_General_History_Entity.network_adapters))" style="white-space: nowrap;">@Localizer["network_adapters"]</MudTh>
                                                            </HeaderContent>
                                                            <RowTemplate Context="device_information_general_history_row">

                                                                <MudTd DataLabel="@Localizer["date"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@device_information_general_history_row.date
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="Version" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.agent_version
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["os"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.operating_system
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["domain"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.domain
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["architecture"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.architecture
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="Antivirus" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.antivirus_solution
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["last_boot"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.last_boot
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["timezone"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.timezone
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["processor"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.cpu
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="Mainboard" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.mainboard
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["gpu"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.gpu
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["ram"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.ram
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="TPM" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.tpm
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["internal_ips"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.ip_address_internal
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["external_ip"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_general_history_row.ip_address_external
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["network_adapters"]" @onclick="() => Device_Information_General_History_RowClickHandler(device_information_general_history_row)" class="@Device_Information_General_History_GetRowClass(device_information_general_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@{
                                                                        try
                                                                        {
                                                                            if (!String.IsNullOrEmpty(device_information_general_history_row.network_adapters))
                                                                            {
                                                                                Logging.Handler.Debug("/devices -> Table", "network_adapters", device_information_general_history_row.network_adapters);

                                                                                string network_adapters_string = String.Empty;

                                                                                // Deserialisierung des JSON-Arrays in dynamische Typen
                                                                                JsonArray network_adapters_array = JsonNode.Parse(device_information_general_history_row.network_adapters).AsArray();

                                                                                // Zugriff auf die Elemente des Arrays
                                                                                foreach (var adapter in network_adapters_array)
                                                                                {
                                                                                    string name = adapter["name"].ToString();
                                                                                    string ipv4_address = adapter["ipv4_address"].ToString();
                                                                                    string ipv6_address = adapter["ipv6_address"].ToString();

                                                                                    network_adapters_string = network_adapters_string + " " + $"{name} ({ipv4_address} & {ipv6_address}), ";
                                                                                }

                                                                                Logging.Handler.Debug("/devices -> Table", "Display network adapters", network_adapters_string);

                                                                                network_adapters_history_display_string = network_adapters_string.Substring(0, network_adapters_string.Length - 2);
                                                                            }
                                                                        }
                                                                        catch (Exception ex)
                                                                        {
                                                                            Logging.Handler.Error("/devices -> Table", "Display network adapters", ex.Message);
                                                                        }
                                                                    }@network_adapters_history_display_string
                                                                </span>
                                                            </MudTd>

                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, 750, 1000, 1250, 1500, 1750, 2000, 2250, 2500, 2750, 3000, 3250, 3500, 3750, 4000, 4250, 4500, 4750, 5000, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>
                                                </ChildContent>
                                            </MudExpansionPanel>

                                        </MudPaper>

                                        <MudPaper Class="mt-5">
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.h6">@Localizer["processor"]</MudText>

                                            <MudCard Elevation="2">
                                                <MudCardContent>
                                                    <MudText Typo="Typo.subtitle1">@Localizer["cpu usage"]: @cpu_usage%</MudText>
                                                    <MudProgressLinear Value="@Convert.ToDouble(@cpu_usage)" Color="GetCpuUsageColor()" />
                                                </MudCardContent>
                                            </MudCard>

                                            <MudTable FixedHeader="true" FixedFooter="true" Hover="true" Dense="true" Items="@cpu_information_mysql_data">
                                                <HeaderContent>
                                                    <MudTh style="white-space: nowrap;">Name</MudTh>
                                                    <MudTh style="white-space: nowrap;">@Localizer["processes"]</MudTh>
                                                    <MudTh style="white-space: nowrap;">Threads</MudTh>
                                                    <MudTh style="white-space: nowrap;">Handles</MudTh>
                                                    <MudTh style="white-space: nowrap;">@Localizer["speed_mhz"]</MudTh>

                                                    @if (platform == "Windows")
                                                    {
                                                        <MudTh style="white-space: nowrap;">@Localizer["base_clock_speed_mhz"]</MudTh>
                                                    }
                                                    
                                                    <MudTh style="white-space: nowrap;">@Localizer["cores"]</MudTh>
                                                    <MudTh style="white-space: nowrap;">@Localizer["logical_processors"]</MudTh>
                                                    
                                                    @if (platform == "Windows")
                                                    {
                                                        <MudTh style="white-space: nowrap;">Sockets</MudTh>
                                                        <MudTh style="white-space: nowrap;">@Localizer["socket_designation"]</MudTh>
                                                        <MudTh style="white-space: nowrap;">@Localizer["virtualization"]</MudTh>
                                                        <MudTh style="white-space: nowrap;">L1-Cache</MudTh>
                                                        <MudTh style="white-space: nowrap;">L2-Cache</MudTh>
                                                    }

                                                    <MudTh style="white-space: nowrap;">L3-Cache</MudTh>

                                                    @if (platform == "Windows")
                                                    {
                                                        <MudTh style="white-space: nowrap;">@Localizer["processor_id"]</MudTh>
                                                        <MudTh style="white-space: nowrap;">Revision</MudTh>
                                                    }

                                                </HeaderContent>
                                                <RowTemplate Context="cpu_information_row">

                                                    <MudTd DataLabel="Name" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.name
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["processes"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.processes
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="Threads" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.threads
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="Handles" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.handles
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["speed_mhz"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.currentclockspeed
                                                        </span>
                                                    </MudTd>

                                                    @if (platform == "Windows")
                                                    {
                                                        <MudTd DataLabel="@Localizer["base_clock_speed_mhz"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@cpu_information_row.maxclockspeed
                                                            </span>
                                                        </MudTd>
                                                    }
                                                    
                                                    <MudTd DataLabel="@Localizer["cores"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.cores
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["logical_processors"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.logical_processors
                                                        </span>
                                                    </MudTd>

                                                    @if (platform == "Windows")
                                                    {
                                                        <MudTd DataLabel="Sockets" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@cpu_information_row.sockets
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["socket_designation"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@cpu_information_row.socket_designation
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["virtualization"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@cpu_information_row.virtualization
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="L1-Cache" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@cpu_information_row.l1_cache
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="L2-Cache" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@cpu_information_row.l2_cache
                                                            </span>
                                                        </MudTd>
                                                    }

                                                    <MudTd DataLabel="L3-Cache" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.l3_cache
                                                        </span>
                                                    </MudTd>

                                                    @if (platform == "Windows")
                                                    {

                                                    <MudTd DataLabel="@Localizer["processor_id"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.processor_id
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="Revision" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@cpu_information_row.revision
                                                        </span>
                                                    </MudTd>

                                                    }

                                                </RowTemplate>
                                            </MudTable>

                                            <MudExpansionPanel Class="mt-2 custom-expansion-panel" @bind-Expanded="device_information_cpu_history_expanded" @bind-Expanded:after="async () => { await Device_Information_CPU_History_Table_Submit_Picker(); }">
                                                <TitleContent>
                                                    <div class="d-flex">
                                                        <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                        <MudText>@Localizer["history"]</MudText>
                                                    </div>
                                                </TitleContent>

                                                <ChildContent>
                                                    <div style="display: flex; align-items: center;">
                                                        <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="device_information_cpu_history_table_picker" @bind-DateRange="device_information_cpu_history_table_dateRange">
                                                            <PickerActions Context="pickerActionsContext">
                                                                <MudButton Class="mr-auto align-self-start" OnClick="@(() => device_information_cpu_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                <MudButton OnClick="@(() => device_information_cpu_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                <MudButton Color="Color.Primary" @onclick="async () => { await Device_Information_CPU_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                            </PickerActions>
                                                        </MudDateRangePicker>

                                                        <MudTooltip Text="@Localizer["export_data"]">
                                                            <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Export_CPU_History_Table_Dialog"></MudIconButton>
                                                        </MudTooltip>
                                                    </div>
                                                    
                                                    <MudPaper Class="doc-section-component-container">
                                                        <MudTimeSeriesChart ChartSeries="@cpu_usage_history_graph_series"
                                                                            @bind-SelectedIndex="cpu_usage_history_graph_index"
                                                                            Width="100%"
                                                                            Height="350px"
                                                                            ChartOptions="@cpu_usage_history_graph_options"
                                                                            AxisChartOptions="@cpu_usage_history_graph_axisChartOptions"
                                                                            CanHideSeries="false"
                                                                            TimeLabelSpacing="TimeSpan.FromMinutes(5)"
                                                                            TimeLabelSpacingRounding="true"
                                                                            TimeLabelSpacingRoundingPadSeries="true"
                                                                            DataMarkerTooltipTimeLabelFormat="yyyy MMM dd HH:mm:ss" 
                                                                            />
                                                    </MudPaper>

                                                    <MudTable Class="mt-2" Height="25vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@device_information_cpu_history_mysql_data">
                                                        <ToolBarContent>
                                                            <MudTextField @bind-Value="device_information_cpu_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                        </ToolBarContent>
                                                        <HeaderContent>
                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.date))" style="white-space: nowrap;">@Localizer["date"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.name))" style="white-space: nowrap;">Name</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.usage))" style="white-space: nowrap;">@Localizer["cpu usage"] (%)</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.processes))" style="white-space: nowrap;">@Localizer["processes"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.threads))" style="white-space: nowrap;">Threads</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.handles))" style="white-space: nowrap;">Handles</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.currentclockspeed))" style="white-space: nowrap;">@Localizer["speed_mhz"]</MudTh>

                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.maxclockspeed))" style="white-space: nowrap;">@Localizer["base_clock_speed_mhz"]</MudTh>
                                                            }

                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.cores))" style="white-space: nowrap;">@Localizer["cores"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.logical_processors))" style="white-space: nowrap;">@Localizer["logical_processors"]</MudTh>
                                                            
                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.sockets))" style="white-space: nowrap;">Sockets</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.socket_designation))" style="white-space: nowrap;">@Localizer["socket_designation"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.virtualization))" style="white-space: nowrap;">@Localizer["virtualization"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.l1_cache))" style="white-space: nowrap;">L1-Cache</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.l2_cache))" style="white-space: nowrap;">L2-Cache</MudTh>    
                                                            }

                                                            <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.l3_cache))" style="white-space: nowrap;">L3-Cache</MudTh>
                                                           
                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.processor_id))" style="white-space: nowrap;">@Localizer["processor_id"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => device_information_cpu_history_table_sorted_column = (nameof(Device_Information_CPU_History_Entity.revision))" style="white-space: nowrap;">Revision</MudTh>
                                                            }

                                                        </HeaderContent>
                                                        <RowTemplate Context="device_information_cpu_history_row">

                                                            <MudTd DataLabel="@Localizer["date"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.date
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="Name" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.name
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["cpu usage"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.usage
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["processes"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.processes
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="Threads" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.threads
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="Handles" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.handles
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["speed_mhz"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.currentclockspeed
                                                                </span>
                                                            </MudTd>

                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTd DataLabel="@Localizer["base_clock_speed_mhz"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@device_information_cpu_history_row.maxclockspeed
                                                                    </span>
                                                                </MudTd>
                                                            }

                                                            <MudTd DataLabel="@Localizer["cores"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.cores
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["logical_processors"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.logical_processors
                                                                </span>
                                                            </MudTd>

                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTd DataLabel="Sockets" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@device_information_cpu_history_row.sockets
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="@Localizer["socket_designation"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@device_information_cpu_history_row.socket_designation
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="@Localizer["virtualization"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@device_information_cpu_history_row.virtualization
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="L1-Cache" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@device_information_cpu_history_row.l1_cache
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="L2-Cache" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@device_information_cpu_history_row.l2_cache
                                                                    </span>
                                                                </MudTd>
                                                            }

                                                            <MudTd DataLabel="L3-Cache" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_cpu_history_row.l3_cache
                                                                </span>
                                                            </MudTd>

                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTd DataLabel="@Localizer["processor_id"]" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@device_information_cpu_history_row.processor_id
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="Revision" @onclick="() => Device_Information_CPU_History_RowClickHandler(device_information_cpu_history_row)" class="@Device_Information_CPU_History_GetRowClass(device_information_cpu_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@device_information_cpu_history_row.revision
                                                                    </span>
                                                                </MudTd>
                                                            }

                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>
                                                </ChildContent>
                                            </MudExpansionPanel>

                                        </MudPaper>

                                        <MudPaper Class="mt-5">
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.h6">@Localizer["ram"]</MudText>

                                            <MudCard Elevation="2">
                                                <MudCardContent>
                                                    <MudText Typo="Typo.subtitle1">@Localizer["ram usage"]: @ram_usage%</MudText>
                                                    <MudProgressLinear Value="@Convert.ToDouble(ram_usage)" Color="GetRAMUsageColor()" />
                                                </MudCardContent>
                                            </MudCard>

                                            <MudTable FixedHeader="true" FixedFooter="true" Hover="true" Dense="true" Items="@ram_information_mysql_data">
                                                <HeaderContent>

                                                    @if (platform == "Windows")
                                                    {
                                                        <MudTh style="white-space: nowrap;">Name</MudTh>
                                                    }

                                                    <MudTh style="white-space: nowrap;">@Localizer["ram_available_mb"]</MudTh>
                                                    <!-- <MudTh style="white-space: nowrap;">Zugesichert (GB)</MudTh> -->

                                                    @if (platform == "Windows" || platform == "Linux")
                                                    {
                                                        <MudTh style="white-space: nowrap;">@Localizer["ram_in_cache_mb"]</MudTh>
                                                        <MudTh style="white-space: nowrap;">@Localizer["ram_outsourced_pool_mb"]</MudTh>
                                                        <MudTh style="white-space: nowrap;">@Localizer["ram_not_outsources_pool_mb"]</MudTh>
                                                    }

                                                    @if (platform == "Windows")
                                                    {
                                                        <MudTh style="white-space: nowrap;">@Localizer["speed_mhz"]</MudTh>
                                                        <MudTh style="white-space: nowrap;">@Localizer["slots"]</MudTh>
                                                        <MudTh style="white-space: nowrap;">@Localizer["slots_used"]</MudTh>
                                                        <MudTh style="white-space: nowrap;">@Localizer["form_factor"]</MudTh>
                                                    }

                                                    <MudTh style="white-space: nowrap;">@Localizer["ram_reserved_for_hardware_mb"]</MudTh>
                                                </HeaderContent>
                                                <RowTemplate Context="ram_information_row">

                                                    @if (platform == "Windows")
                                                    {
                                                        <MudTd DataLabel="Name" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@ram_information_row.name
                                                            </span>
                                                        </MudTd>
                                                    }
                                                    
                                                    @if (platform == "Windows" || platform == "Linux")
                                                    {
                                                        <MudTd DataLabel="@Localizer["ram_in_cache_mb"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@ram_information_row.cache
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["ram_outsourced_pool_mb"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@ram_information_row.outsourced_pool
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["ram_not_outsources_pool_mb"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@ram_information_row.not_outsourced_pool
                                                            </span>
                                                        </MudTd>
                                                    }

                                                    <MudTd DataLabel="@Localizer["ram_available_mb"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.available
                                                        </span>
                                                    </MudTd>

                                                    <!-- <MudTd DataLabel="Zugesichert (GB)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.assured
                                                        </span>
                                                    </MudTd> -->

                                                    @if (platform == "Windows")
                                                    {
                                                        <MudTd DataLabel="@Localizer["speed_mhz"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@ram_information_row.speed
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["slots"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@ram_information_row.slots
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["slots_used"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@ram_information_row.slots_used
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["form_factor"]" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@ram_information_row.form_factor
                                                            </span>
                                                        </MudTd>
                                                    }

                                                    <MudTd DataLabel="@Localizer["ram_reserved_for_hardware_mb"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.hardware_reserved
                                                        </span>
                                                    </MudTd>

                                                </RowTemplate>
                                            </MudTable>

                                            <MudExpansionPanel Class="mt-2 custom-expansion-panel" @bind-Expanded="ram_history_history_expanded" @bind-Expanded:after="async () => { await RAM_History_Table_Submit_Picker(); }">
                                                <TitleContent>
                                                    <div class="d-flex">
                                                        <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                        <MudText>@Localizer["history"]</MudText>
                                                    </div>
                                                </TitleContent>

                                                <ChildContent>
                                                    <div style="display: flex; align-items: center;">
                                                        <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="ram_history_table_picker" @bind-DateRange="ram_history_table_dateRange">
                                                            <PickerActions Context="pickerActionsContext">
                                                                <MudButton Class="mr-auto align-self-start" OnClick="@(() => ram_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                <MudButton OnClick="@(() => ram_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                <MudButton Color="Color.Primary" @onclick="async () => { await RAM_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                            </PickerActions>
                                                        </MudDateRangePicker>

                                                        <MudTooltip Text="@Localizer["export_data"]">
                                                            <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Export_RAM_History_Table_Dialog"></MudIconButton>
                                                        </MudTooltip>
                                                    </div>

                                                    <MudPaper Class="doc-section-component-container">
                                                        <MudTimeSeriesChart ChartSeries="@ram_usage_history_graph_series"
                                                                            @bind-SelectedIndex="ram_usage_history_graph_index"
                                                                            Width="100%"
                                                                            Height="350px"
                                                                            ChartOptions="@ram_usage_history_graph_options"
                                                                            AxisChartOptions="@ram_usage_history_graph_axisChartOptions"
                                                                            CanHideSeries="false"
                                                                            TimeLabelSpacingRounding="true"
                                                                            TimeLabelSpacingRoundingPadSeries="true"
                                                                            DataMarkerTooltipTimeLabelFormat="yyyy MMM dd HH:mm:ss" />
                                                    </MudPaper>

                                                    <MudTable Class="mt-2" Height="25vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@ram_history_mysql_data" Filter="new Func<RAM_History_Entity, bool>(RAM_History_Table_Filter_Func)">
                                                        <ToolBarContent>
                                                            <MudTextField Class="mt-0" @bind-Value="ram_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                        </ToolBarContent>
                                                        <HeaderContent>
                                                            <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.date))" style="white-space: nowrap;">@Localizer["date"]</MudTh>

                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.name))" style="white-space: nowrap;">Name</MudTh>
                                                            }

                                                            <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.available))" style="white-space: nowrap;">@Localizer["ram_available_mb"]</MudTh>
                                                            <!--<MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.assured))" style="white-space: nowrap;">Zugesichert (GB)</MudTh>-->

                                                            @if (platform == "Windows" || platform == "Linux")
                                                            {
                                                                <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.cache))" style="white-space: nowrap;">@Localizer["ram_in_cache_mb"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.outsourced_pool))" style="white-space: nowrap;">@Localizer["ram_outsourced_pool_mb"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.not_outsourced_pool))" style="white-space: nowrap;">@Localizer["ram_not_outsources_pool_mb"]</MudTh>
                                                            }

                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.speed))" style="white-space: nowrap;">@Localizer["speed_mhz"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.slots))" style="white-space: nowrap;">@Localizer["slots"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.slots_used))" style="white-space: nowrap;">@Localizer["slots_used"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.form_factor))" style="white-space: nowrap;">@Localizer["form_factor"]</MudTh>
                                                            }
                                                            
                                                            <MudTh Sortable="true" @onclick="() => ram_history_table_sorted_column = (nameof(RAM_History_Entity.hardware_reserved))" style="white-space: nowrap;">@Localizer["ram_reserved_for_hardware_mb"]</MudTh>
                                                        </HeaderContent>

                                                        <RowTemplate Context="ram_history_row">

                                                            <MudTd DataLabel="@Localizer["date"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@ram_history_row.date
                                                                </span>
                                                            </MudTd>

                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTd DataLabel="Name" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@ram_history_row.name
                                                                    </span>
                                                                </MudTd>
                                                            }

                                                            <MudTd DataLabel="@Localizer["ram_available_mb"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@ram_history_row.available
                                                                </span>
                                                            </MudTd>

                                                            <!--<MudTd DataLabel="Zugesichert (GB)" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@ram_history_row.assured
                                                                </span>
                                                            </MudTd>-->

                                                            @if (platform == "Windows" || platform == "Linux")
                                                            {
                                                                <MudTd DataLabel="@Localizer["ram_in_cache_mb"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@ram_history_row.cache
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="@Localizer["ram_outsourced_pool_mb"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@ram_history_row.outsourced_pool
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="@Localizer["ram_not_outsources_pool_mb"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@ram_history_row.not_outsourced_pool
                                                                    </span>
                                                                </MudTd>
                                                            }

                                                            @if (platform == "Windows")
                                                            {
                                                                <MudTd DataLabel="@Localizer["speed_mhz"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@ram_history_row.speed
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="@Localizer["slots"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@ram_history_row.slots
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="@Localizer["slots_used"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@ram_history_row.slots_used
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="@Localizer["form_factor"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@ram_history_row.form_factor
                                                                    </span>
                                                                </MudTd>
                                                            }

                                                            <MudTd DataLabel="@Localizer["ram_reserved_for_hardware_mb"]" @onclick="() => RAM_History_RowClickHandler(ram_history_row)" class="@RAM_History_GetRowClass(ram_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@ram_history_row.hardware_reserved
                                                                </span>
                                                            </MudTd>

                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>
                                                </ChildContent>
                                            </MudExpansionPanel>
                                        </MudPaper>

                                        <MudPaper Class="mt-5">
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.h6">@Localizer["network"]</MudText>

                                            <MudTable FixedHeader="true" FixedFooter="true" Hover="true" Dense="true" Items="@device_information_network_information_mysql_data">
                                                
                                                <HeaderContent>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.name)">Name</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.description)">@Localizer["description"]</MudTableSortLabel>
                                                    </MudTh>

                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.type)">@Localizer["connection_type"]</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.link_speed)">@Localizer["Link_speed_(MBit/s)"]</MudTableSortLabel>
                                                    </MudTh>

                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.service_name)">@Localizer["service"]</MudTableSortLabel>
                                                    </MudTh>

                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.dns_domain)">@Localizer["dns_domain"]</MudTableSortLabel>
                                                    </MudTh>

                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.dns_hostname)">@Localizer["dns_hostname"]</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.dhcp_enabled)">@Localizer["dhcp_enabled"]</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.dhcp_server)">@Localizer["dhcp_server"]</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.ipv4_address)">@Localizer["ipv4_address"]</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.ipv6_address)">@Localizer["ipv6_address"]</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.subnet_mask)">@Localizer["subnet_mask"]</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.mac_address)">@Localizer["mac_address"]</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.sending)">@Localizer["send_kbits"]</MudTableSortLabel>
                                                    </MudTh>
                                                    <MudTh Style="white-space: nowrap;">
                                                        <MudTableSortLabel SortBy="new Func<Device_Information_Network_Entity, object>(x => x.receive)">@Localizer["receive_kbits"]</MudTableSortLabel>
                                                    </MudTh>
                                                </HeaderContent>

                                                <RowTemplate Context="ram_information_row">

                                                    <MudTd DataLabel="Name" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.name
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["description"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.description
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["connection_type"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.type
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["Link_speed_(MBit/s)"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.link_speed
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["service"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.service_name
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["dns_domain"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.dns_domain
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["dns_hostname"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.dns_hostname
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["dhcp_enabled"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.dhcp_enabled
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["dhcp_server"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.dhcp_server
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["ipv4_address"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.ipv4_address
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["ipv6_address"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.ipv6_address
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["subnet_mask"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.subnet_mask
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["mac_address"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.mac_address
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["send_kbits"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.sending
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["receive_kbits"]" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@ram_information_row.receive
                                                        </span>
                                                    </MudTd>

                                                </RowTemplate>
                                            </MudTable>

                                            <MudExpansionPanel Class="mt-2 custom-expansion-panel" @bind-Expanded="device_information_network_adapters_history_expanded" @bind-Expanded:after="async () => { await Device_Information_Network_Adapters_History_Table_Submit_Picker(); }">
                                                <TitleContent>
                                                    <div class="d-flex">
                                                        <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                        <MudText>@Localizer["history"]</MudText>
                                                    </div>
                                                </TitleContent>

                                                <ChildContent>
                                                    <div style="display: flex; align-items: center;">
                                                        <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="device_information_network_adapters_history_table_picker" @bind-DateRange="device_information_network_adapters_history_table_dateRange">
                                                            <PickerActions Context="pickerActionsContext">
                                                                <MudButton Class="mr-auto align-self-start" OnClick="@(() => device_information_network_adapters_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                <MudButton OnClick="@(() => device_information_network_adapters_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                <MudButton Color="Color.Primary" @onclick="async () => { await Device_Information_Network_Adapters_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                            </PickerActions>
                                                        </MudDateRangePicker>

                                                        <MudTooltip Text="@Localizer["export_data"]">
                                                            <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Export_Network_Adapters_History_Table_Dialog"></MudIconButton>
                                                        </MudTooltip>
                                                    </div>

                                                    <MudTable Class="mt-2" Height="25vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@device_information_network_adapters_history_mysql_data" GroupBy="@device_information_network_adapters_history_groupDefinition" Filter="new Func<Device_Information_Network_Adapters_History_Entity, bool>(Device_Information_Network_Adapters_History_Table_Filter_Func)">
                                                        <ToolBarContent>
                                                            <MudTextField Class="mt-0" @bind-Value="device_information_network_adapters_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                        </ToolBarContent>
                                                        <HeaderContent>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.date))" style="white-space: nowrap;">@Localizer["date"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.name))" style="white-space: nowrap;">Name</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.description))" style="white-space: nowrap;">@Localizer["description"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.type))" style="white-space: nowrap;">@Localizer["connection_type"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.link_speed))" style="white-space: nowrap;">@Localizer["Link_speed_(MBit/s)"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.service_name))" style="white-space: nowrap;">@Localizer["service"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.dns_domain))" style="white-space: nowrap;">@Localizer["dns_domain"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.dns_hostname))" style="white-space: nowrap;">@Localizer["dns_hostname"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.dhcp_enabled))" style="white-space: nowrap;">@Localizer["dhcp_enabled"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.dhcp_server))" style="white-space: nowrap;">@Localizer["dhcp_server"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.ipv4_address))" style="white-space: nowrap;">@Localizer["ipv4_address"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.ipv6_address))" style="white-space: nowrap;">@Localizer["ipv6_address"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.subnet_mask))" style="white-space: nowrap;">@Localizer["subnet_mask"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.mac_address))" style="white-space: nowrap;">@Localizer["mac_address"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.sending))" style="white-space: nowrap;">@Localizer["send_kbits"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_network_adapters_history_table_sorted_column = (nameof(Device_Information_Network_Adapters_History_Entity.receive))" style="white-space: nowrap;">@Localizer["receive_kbits"]</MudTh>
                                                        </HeaderContent>
                                                        <GroupHeaderTemplate Context="groupContext">
    	                                                    <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                        </GroupHeaderTemplate>

                                                        <RowTemplate Context="network_adapters_history_row">

                                                            <MudTd DataLabel="@Localizer["date"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.date
                                                                </span>
                                                            </MudTd>
                                                             
                                                            <MudTd DataLabel="Name" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.name
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["description"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.description
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["connection_type"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.type
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="Link-Geschwindigkeit MBit/s" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.link_speed
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["service"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.service_name
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["dns_domain"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.dns_domain
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["dns_hostname"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.dns_hostname
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["dhcp_enabled"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.dhcp_enabled
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["dhcp_server"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.dhcp_server
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["ipv4_address"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.ipv4_address
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["ipv6_address"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.ipv6_address
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["subnet_mask"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.subnet_mask
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["mac_address"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.mac_address
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["send_kbits"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.sending
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["receive_kbits"]" @onclick="() => Device_Information_Network_Adapters_History_RowClickHandler(network_adapters_history_row)" class="@Device_Information_Network_Adapters_History_GetRowClass(network_adapters_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@network_adapters_history_row.receive
                                                                </span>
                                                            </MudTd>

                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>
                                                </ChildContent>
                                            </MudExpansionPanel>
                                        </MudPaper>

                                        <MudPaper Class="mt-5">
                                            <MudText Class="ml-2" Typo="Typo.h6">@Localizer["drives"]</MudText>

                                            @{
                                                try
                                                {
                                                    <div>
                                                        @foreach (var disk in device_information_disks_list)
                                                        {
                                                            try
                                                            {
                                                                string letter = disk.letter;
                                                                string label = disk.label;
                                                                string capacity = disk.capacity.Replace(",", "."); 
                                                                string usage = disk.usage.Replace(",", ".");

                                                                string model = String.IsNullOrEmpty(disk.model) ? "N/A" : disk.model;
                                                                string firmware_revision = disk.firmware_revision;
                                                                string serial_number = disk.serial_number;
                                                                string interface_type = disk.interface_type;
                                                                string drive_type = disk.drive_type;
                                                                string drive_format = disk.drive_format;
                                                                string drive_ready = disk.drive_ready;

                                                                if (drive_type == "0") drive_type = Localizer["removable"];
                                                                else if (drive_type == "1") drive_type = Localizer["fixed"];
                                                                else if (drive_type == "2") drive_type = Localizer["network"];
                                                                else if (drive_type == "5") drive_type = Localizer["unknown"];

                                                                drive_ready = drive_ready == "True" ? Localizer["yes"] : Localizer["no"];

                                                                double capacityGB = Math.Round(double.Parse(capacity, CultureInfo.InvariantCulture), 2);
                                                                double usagePercentage = double.Parse(usage, CultureInfo.InvariantCulture);
                                                                double usedSpaceGB = Math.Round((capacityGB * usagePercentage) / 100, 2);
                                                                double freeSpaceGB = Math.Round(capacityGB - usedSpaceGB, 2);

                                                                // Check if usage is above 1%. If not, dont continue
                                                                //if (usagePercentage < 1) continue;

                                                                usedSpaceGB = Math.Truncate(usedSpaceGB * 100) / 100;
                                                                freeSpaceGB = Math.Truncate(freeSpaceGB * 100) / 100;

                                                                // Color-Thresholds: <=50 = Success, 50..80 = Warning, >85 = Error
                                                                Color progressColor;
                                                                if (usagePercentage <= 50) progressColor = Color.Info;
                                                                else if (usagePercentage <= 85) progressColor = Color.Warning;
                                                                else progressColor = Color.Error;

                                                                <MudPaper Class="mt-3" Elevation="0">
                                                                
                                                                @if (platform == "Windows")
                                                                {
                                                                    <MudText Class="ml-2" Typo="Typo.h6">@letter (@label)</MudText>
                                                                }
                                                                else
                                                                {
                                                                    <MudText Class="ml-2" Typo="Typo.h6">@letter</MudText>
                                                                }

                                                                <MudText Class="ml-2" Typo="Typo.body2">Capacity: @capacityGB.ToString("N0", CultureInfo.InvariantCulture) GB</MudText>

                                                                <MudProgressLinear Class="mt-2 ml-2 mr-2" Value="@(usagePercentage)" BufferValue="100" Striped="false" Rounded="true" Color="@progressColor"><MudText Typo="Typo.body1">@Math.Round(usagePercentage) %</MudText></MudProgressLinear>

                                                                <div class="d-flex" style="justify-content:space-between; margin-top:8px; font-size:0.88rem; color:var(--mud-palette-text-secondary);">
                                                                    <div class="ml-2">Used: @usedSpaceGB (GB)</div>
                                                                        <div class="mr-2">@Localizer["free"]: @freeSpaceGB (GB)</div>
                                                                    </div>

                                                                    @if (platform == "Windows")
                                                                    {
                                                                        <div class="ml-2">@Localizer["model"]: @model</div>
                                                                    }
                                                                    <div class="ml-2">@Localizer["type"]: @drive_type</div>
                                                                    <div class="ml-2">@Localizer["file_system"]: @drive_format</div>
                                                                    <div class="ml-2">@Localizer["ready"]: @drive_ready</div>
                                                                </MudPaper>
                                                            }
                                                            catch (Exception ex)
                                                            {
                                                                Logging.Handler.Error("/devices -> Table", "Display disks", ex.ToString());
                                                            }
                                                        }
                                                    </div>
                                                }
                                                catch (Exception ex)
                                                {
                                                    Logging.Handler.Error("/devices -> Table", "Display disks", ex.ToString());
                                                }
                                            }

                                            <MudExpansionPanel Class="mt-2 custom-expansion-panel" @bind-Expanded="device_information_disks_history_expanded" @bind-Expanded:after="async () => { await Device_Information_Disks_History_Table_Submit_Picker(); }">
                                                <TitleContent>
                                                    <div class="d-flex">
                                                        <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                        <MudText>@Localizer["history"]</MudText>
                                                    </div>
                                                </TitleContent>

                                                <ChildContent>
                                                    <div style="display: flex; align-items: center;">
                                                        <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="device_information_disks_history_table_picker" @bind-DateRange="device_information_disks_history_table_dateRange">
                                                            <PickerActions Context="pickerActionsContext">
                                                                <MudButton Class="mr-auto align-self-start" OnClick="@(() => device_information_disks_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                <MudButton OnClick="@(() => device_information_disks_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                <MudButton Color="Color.Primary" @onclick="async () => { await Device_Information_Disks_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                            </PickerActions>
                                                        </MudDateRangePicker>

                                                        <MudTooltip Text="@Localizer["export_data"]">
                                                            <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Export_Disks_History_Table_Dialog"></MudIconButton>
                                                        </MudTooltip>
                                                    </div>

                                                    <MudTable Class="mt-2" Height="25vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@device_information_disks_history_mysql_data" GroupBy="@device_information_disks_history_groupDefinition" Filter="new Func<Device_Information_Disks_History_Entity, bool>(Device_Information_Disks_History_Table_Filter_Func)">
                                                        <ToolBarContent>
                                                            <MudTextField Class="mt-0" @bind-Value="device_information_disks_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                        </ToolBarContent>
                                                        <HeaderContent>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.date))" style="white-space: nowrap;">@Localizer["date"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.letter))" style="white-space: nowrap;">@Localizer["letter"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.label))" style="white-space: nowrap;">Label</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.model))" style="white-space: nowrap;">@Localizer["model"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.firmware_revision))" style="white-space: nowrap;">@Localizer["firmware_revision"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.serial_number))" style="white-space: nowrap;">@Localizer["serial_number"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.interface_type))" style="white-space: nowrap;">Interface</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.drive_type))" style="white-space: nowrap;">@Localizer["type"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.drive_format))" style="white-space: nowrap;">@Localizer["file_system"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.drive_ready))" style="white-space: nowrap;">@Localizer["ready"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.capacity))" style="white-space: nowrap;">@Localizer["capacity_gb"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.usage))" style="white-space: nowrap;">@Localizer["occupied_%"]</MudTh>
                                                            
                                                            @*
                                                            <MudTh Sortable="true" @onclick="() => device_information_disks_history_table_sorted_column = (nameof(Device_Information_Disks_History_Entity.status))" style="white-space: nowrap;">Status</MudTh>
                                                            *@
                                                        </HeaderContent>
                                                        <GroupHeaderTemplate Context="groupContext">
                                                            <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                        </GroupHeaderTemplate>
                                                        <RowTemplate Context="device_information_disks_history_row">

                                                            <MudTd DataLabel="@Localizer["date"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.date
                                                                </span>
                                                            </MudTd>
                                                            <MudTd DataLabel="@Localizer["letter"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.letter
                                                                </span>
                                                            </MudTd>
                                                            <MudTd DataLabel="Label" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.label
                                                                </span>
                                                            </MudTd>
                                                            <MudTd DataLabel="@Localizer["model"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.model
                                                                </span>
                                                            </MudTd>
                                                            <MudTd DataLabel="@Localizer["firmware_revision"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.firmware_revision
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["serial_number"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.serial_number
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="Interface" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.interface_type
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["type"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.drive_type
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["file_system"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.drive_format
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["ready"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.drive_ready
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["capacity_gb"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.capacity
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["occupied_%"]" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.usage
                                                                </span>
                                                            </MudTd>

                                                            @*
                                                            <MudTd DataLabel="Status" @onclick="() => Device_Information_Disks_History_RowClickHandler(device_information_disks_history_row)" class="@Device_Information_Disks_History_GetRowClass(device_information_disks_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_disks_history_row.status
                                                                </span>
                                                            </MudTd>
                                                            *@
                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>
                                                </ChildContent>
                                            </MudExpansionPanel>
                                        </MudPaper>

                                        @if (platform == "Windows")
                                        {
                                            <MudPaper Class="mt-5">

                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.h6">@Localizer["antivirus_products"]</MudText>

                                            <MudTable FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@antivirus_products_mysql_data" Filter="new Func<Antivirus_Products_Entity, bool>(Antivirus_Products_Table_Filter_Func)">
                                                <HeaderContent>
                                                    <MudTh Sortable="true" @onclick="() => antivirus_products_table_sorted_column = (nameof(Antivirus_Products_Entity.display_name))" style="white-space: nowrap;">@Localizer["display_name"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => antivirus_products_table_sorted_column = (nameof(Antivirus_Products_Entity.instance_guid))" style="white-space: nowrap;">@Localizer["instance_guid"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => antivirus_products_table_sorted_column = (nameof(Antivirus_Products_Entity.path_to_signed_product_exe))" style="white-space: nowrap;">@Localizer["Path to the signed product executable"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => antivirus_products_table_sorted_column = (nameof(Antivirus_Products_Entity.path_to_signed_reporting_exe))" style="white-space: nowrap;">@Localizer["Path to the signed reporting executable"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => antivirus_products_table_sorted_column = (nameof(Antivirus_Products_Entity.product_state))" style="white-space: nowrap;">@Localizer["product_state"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => antivirus_products_table_sorted_column = (nameof(Antivirus_Products_Entity.timestamp))" style="white-space: nowrap;">@Localizer["timestamp"]</MudTh>
                                                </HeaderContent>

                                                <RowTemplate Context="antivirus_products_row">

                                                    <MudTd DataLabel="@Localizer["display_name"]" @onclick="() => Antivirus_Products_RowClickHandler(antivirus_products_row)" class="@Antivirus_Products_GetRowClass(antivirus_products_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@antivirus_products_row.display_name
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["instance_guid"]" @onclick="() => Antivirus_Products_RowClickHandler(antivirus_products_row)" class="@Antivirus_Products_GetRowClass(antivirus_products_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@antivirus_products_row.instance_guid
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["Path to the signed product executable"]" @onclick="() => Antivirus_Products_RowClickHandler(antivirus_products_row)" class="@Antivirus_Products_GetRowClass(antivirus_products_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@antivirus_products_row.path_to_signed_product_exe
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["Path to the signed reporting executable"]" @onclick="() => Antivirus_Products_RowClickHandler(antivirus_products_row)" class="@Antivirus_Products_GetRowClass(antivirus_products_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@antivirus_products_row.path_to_signed_reporting_exe
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["product_state"]" @onclick="() => Antivirus_Products_RowClickHandler(antivirus_products_row)" class="@Antivirus_Products_GetRowClass(antivirus_products_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@antivirus_products_row.product_state
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["timestamp"]" @onclick="() => Antivirus_Products_RowClickHandler(antivirus_products_row)" class="@Antivirus_Products_GetRowClass(antivirus_products_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@antivirus_products_row.timestamp
                                                        </span>
                                                    </MudTd>

                                                </RowTemplate>
                                            </MudTable>

                                            <MudExpansionPanel Class="mt-2 custom-expansion-panel" @bind-Expanded="antivirus_products_history_expanded" @bind-Expanded:after="async () => { await Antivirus_Products_History_Table_Submit_Picker(); }">
                                                <TitleContent>
                                                    <div class="d-flex">
                                                        <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                        <MudText>@Localizer["history"]</MudText>
                                                    </div>
                                                </TitleContent>

                                                <ChildContent>
                                                    <div style="display: flex; align-items: center;">
                                                        <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="antivirus_products_history_table_picker" @bind-DateRange="antivirus_products_history_table_dateRange" >
                                                            <PickerActions Context="pickerActionsContext">
                                                                <MudButton Class="mr-auto align-self-start" OnClick="@(() => antivirus_products_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                <MudButton OnClick="@(() => antivirus_products_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                <MudButton Color="Color.Primary" @onclick="async () => { await Antivirus_Products_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                            </PickerActions>
                                                        </MudDateRangePicker>

                                                        <MudTooltip Text="@Localizer["export_data"]">
                                                            <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Export_Antivirus_Products_History_Table_Dialog"></MudIconButton>
                                                        </MudTooltip>
                                                    </div>

                                                    <MudTable Class="mt-5" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@antivirus_products_history_mysql_data" GroupBy="@antivirus_products_history_groupDefinition" Filter="new Func<Antivirus_Products_History_Entity, bool>(Antivirus_Products_History_Table_Filter_Func)">
                                                        <ToolBarContent>
                                                            <MudTextField Class="mt-0" @bind-Value="antivirus_products_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                        </ToolBarContent>
                                                        <HeaderContent>
                                                            <MudTh Sortable="true" @onclick="() => antivirus_products_history_table_sorted_column = (nameof(Antivirus_Products_History_Entity.display_name))" style="white-space: nowrap;">@Localizer["display_name"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => antivirus_products_history_table_sorted_column = (nameof(Antivirus_Products_History_Entity.instance_guid))" style="white-space: nowrap;">@Localizer["instance_guid"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => antivirus_products_history_table_sorted_column = (nameof(Antivirus_Products_History_Entity.path_to_signed_product_exe))" style="white-space: nowrap;">@Localizer["Path to the signed product executable"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => antivirus_products_history_table_sorted_column = (nameof(Antivirus_Products_History_Entity.path_to_signed_reporting_exe))" style="white-space: nowrap;">@Localizer["Path to the signed reporting executable"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => antivirus_products_history_table_sorted_column = (nameof(Antivirus_Products_History_Entity.product_state))" style="white-space: nowrap;">@Localizer["product_state"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => antivirus_products_history_table_sorted_column = (nameof(Antivirus_Products_History_Entity.timestamp))" style="white-space: nowrap;">@Localizer["timestamp"]</MudTh>
                                                        </HeaderContent>
                                                        <GroupHeaderTemplate Context="groupContext">
                                                            <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                        </GroupHeaderTemplate>
                                                        <RowTemplate Context="antivirus_products_history_row">

                                                            <MudTd DataLabel="@Localizer["display_name"]" @onclick="() => Antivirus_Products_History_RowClickHandler(antivirus_products_history_row)" class="@Antivirus_Products_History_GetRowClass(antivirus_products_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@antivirus_products_history_row.display_name
                                                                </span>
                                                            </MudTd>
                                                            <MudTd DataLabel="@Localizer["instance_guid"]" @onclick="() => Antivirus_Products_History_RowClickHandler(antivirus_products_history_row)" class="@Antivirus_Products_History_GetRowClass(antivirus_products_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@antivirus_products_history_row.instance_guid
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["Path to the signed product executable"]" @onclick="() => Antivirus_Products_History_RowClickHandler(antivirus_products_history_row)" class="@Antivirus_Products_History_GetRowClass(antivirus_products_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@antivirus_products_history_row.path_to_signed_product_exe
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["Path to the signed reporting executable"]" @onclick="() => Antivirus_Products_History_RowClickHandler(antivirus_products_history_row)" class="@Antivirus_Products_History_GetRowClass(antivirus_products_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@antivirus_products_history_row.path_to_signed_reporting_exe
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["product_state"]" @onclick="() => Antivirus_Products_History_RowClickHandler(antivirus_products_history_row)" class="@Antivirus_Products_History_GetRowClass(antivirus_products_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@antivirus_products_history_row.product_state
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["timestamp"]" @onclick="() => Antivirus_Products_History_RowClickHandler(antivirus_products_history_row)" class="@Antivirus_Products_History_GetRowClass(antivirus_products_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@antivirus_products_history_row.timestamp
                                                                </span>
                                                            </MudTd>

                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>
                                                </ChildContent>
                                            </MudExpansionPanel>

                                        </MudPaper>
                                        }

                                        <MudPaper Class="mt-5">
                                            <MudText Class="ml-2" Typo="Typo.h6">@Localizer["notes"]</MudText>
                                            <MudTextField Class="ml-2 mr-2" T="string" Lines="10" Variant="Variant.Outlined" @bind-Text="notes_string" Disabled="@notes_disabled" />
                                            <MudButton Class="mt-2 ml-2" Size="Size.Small" Variant="Variant.Filled" OnClick="@Notes_Save" Color="Color.Success" StartIcon="@Icons.Material.Filled.Save">@Localizer["save"]</MudButton>
                                            <MudButton Class="mt-2 ml-2" Size="Size.Small" Variant="Variant.Filled" OnClick="@Notes_Edit_Form" Color="Color.Default" StartIcon="@Icons.Material.Filled.Edit">@Localizer["edit"]</MudButton>

                                            <MudExpansionPanel Class="mt-2 custom-expansion-panel" @bind-Expanded="device_information_notes_history_expanded" @bind-Expanded:after="async () => { await Device_Information_Notes_History_Table_Submit_Picker(); }">
                                                <TitleContent>
                                                    <div class="d-flex">
                                                        <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                        <MudText>@Localizer["history"]</MudText>
                                                    </div>
                                                </TitleContent>

                                                <ChildContent>

                                                    <div style="display: flex; align-items: center;">
                                                        <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="device_information_notes_history_table_picker" @bind-DateRange="device_information_notes_history_table_dateRange">
                                                            <PickerActions Context="pickerActionsContext">
                                                                <MudButton Class="mr-auto align-self-start" OnClick="@(() => device_information_notes_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                <MudButton OnClick="@(() => device_information_notes_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                <MudButton Color="Color.Primary" @onclick="async () => { await Device_Information_Notes_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                            </PickerActions>
                                                        </MudDateRangePicker>

                                                        <MudTooltip Text="@Localizer["export_data"]">
                                                            <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Notes_History_Table_Dialog"></MudIconButton>
                                                        </MudTooltip>
                                                    </div>

                                                    <MudTable Class="mt-5" Height="25vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@device_information_notes_history_mysql_data" Filter="new Func<Device_Information_Notes_History_Entity, bool>(Device_Information_Notes_History_Table_Filter_Func)">
                                                        <ToolBarContent>
                                                            <MudTextField @bind-Value="device_information_notes_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                        </ToolBarContent>
                                                        <HeaderContent>
                                                            <MudTh Sortable="true" @onclick="() => device_information_notes_history_table_sorted_column = (nameof(Device_Information_Notes_History_Entity.date))" style="white-space: nowrap;">@Localizer["date"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_notes_history_table_sorted_column = (nameof(Device_Information_Notes_History_Entity.author))" style="white-space: nowrap;">@Localizer["author"]</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => device_information_notes_history_table_sorted_column = (nameof(Device_Information_Notes_History_Entity.note))" style="white-space: nowrap;">@Localizer["notes"]</MudTh>
                                                        </HeaderContent>
                                                        <RowTemplate Context="device_information_notes_history_row">

                                                            <MudTd DataLabel="@Localizer["date"]" @onclick="() => Device_Information_Notes_History_RowClickHandler(device_information_notes_history_row)" class="@Device_Information_Notes_History_GetRowClass(device_information_notes_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_notes_history_row.date
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["author"]" @onclick="() => Device_Information_Notes_History_RowClickHandler(device_information_notes_history_row)" class="@Device_Information_Notes_History_GetRowClass(device_information_notes_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_notes_history_row.author
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["note"]" @onclick="() => Device_Information_Notes_History_RowClickHandler(device_information_notes_history_row)" class="@Device_Information_Notes_History_GetRowClass(device_information_notes_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@device_information_notes_history_row.note
                                                                </span>
                                                            </MudTd>

                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>
                                                </ChildContent>
                                            </MudExpansionPanel>

                                        </MudPaper>

                                        @*
                                        <MudPaper Class="mt-5">
                                            <MudText Class="ml-2" Typo="Typo.h6">Support @Localizer["history"]</MudText>

                                            <div style="display: flex; align-items: center;">
                                                <MudDateRangePicker Class="ml-2" PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="device_information_support_history_table_picker" @bind-DateRange="device_information_support_history_table_dateRange">
                                                    <PickerActions Context="pickerActionsContext">
                                                        <MudButton Class="mr-auto align-self-start" OnClick="@(() => device_information_support_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                        <MudButton OnClick="@(() => device_information_support_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                        <MudButton Color="Color.Primary" @onclick="async () => { await Device_Information_Support_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                    </PickerActions>
                                                </MudDateRangePicker>

                                                <MudTooltip Text="@Localizer["export_data"]">
                                                    <MudIconButton Class="ml-2 mt-5 mr-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Support_History_Table_Dialog"></MudIconButton>
                                                </MudTooltip>
                                            </div>

                                            <MudTable Class="ml-2 mt-2 mr-2" Height="20vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@support_history_mysql_data" Filter="new Func<Support_History_Entity, bool>(Support_History_Table_Filter_Func)">
                                                <ToolBarContent>
                                                    <MudTextField @bind-Value="support_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                </ToolBarContent>
                                                <HeaderContent>
                                                    <MudTh Sortable="true" @onclick="() => support_history_table_sorted_column = (nameof(Support_History_Entity.date))" style="white-space: nowrap;">@Localizer["date"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => support_history_table_sorted_column = (nameof(Support_History_Entity.username))" style="white-space: nowrap;">@Localizer["author"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => support_history_table_sorted_column = (nameof(Support_History_Entity.description))" style="white-space: nowrap;">@Localizer["description"]</MudTh>
                                                </HeaderContent>
                                                <RowTemplate Context="support_history_row">

                                                    <MudTd DataLabel="@Localizer["date"]" @onclick="() => Support_History_RowClickHandler(support_history_row)" class="@Support_History_GetRowClass(support_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            <MudIcon Icon="@Icons.Material.Filled.DateRange" Size="Size.Small" />&nbsp;@support_history_row.date
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["author"]" @onclick="() => Support_History_RowClickHandler(support_history_row)" class="@Support_History_GetRowClass(support_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            <MudIcon Icon="@Icons.Material.Filled.SupportAgent" Size="Size.Small" />&nbsp;@support_history_row.username
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["description"]" @onclick="() => Support_History_RowClickHandler(support_history_row)" class="@Support_History_GetRowClass(support_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            <MudIcon Icon="@Icons.Material.Filled.Description" Size="Size.Small" />&nbsp;@support_history_row.description
                                                        </span>
                                                    </MudTd>

                                                </RowTemplate>
                                                <PagerContent>
                                                    <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                </PagerContent>
                                            </MudTable>

                                            <MudNavLink Disabled="true"></MudNavLink>

                                        </MudPaper>
                                        *@
                                    </MudTabPanel>
                            }

                            @if (permissions_devices_software)
                            {
                                <MudTabPanel Text="@Localizer["software"]">
                                    <MudTabs KeepPanelsAlive=true Elevation="4" Rounded="false" Color="@Color.Default">
                                        <MudTabPanel Text="@Localizer["installed"]">

                                            <MudPaper>

                                                <MudTooltip Text="@Localizer["export_data"]">
                                                    <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Installed_Application_Table_Dialog"></MudIconButton>
                                                </MudTooltip>

                                                <MudTable Class="mt-0" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@software_installed_mysql_data" Filter="new Func<Software_Installed_Entity, bool>(Software_Installed_Table_Filter_Func)">
                                                    <ToolBarContent>
                                                        <MudTextField @bind-Value="software_installed_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                    </ToolBarContent>
                                                    <HeaderContent>
                                                        <MudTh Style="white-space: nowrap;">
                                                            <MudTableSortLabel SortBy="new Func<Software_Installed_Entity, object>(x => x.name)">Name</MudTableSortLabel>
                                                        </MudTh>
                                                        <MudTh Style="white-space: nowrap;">
                                                            <MudTableSortLabel SortBy="new Func<Software_Installed_Entity, object>(x => x.version)">Version</MudTableSortLabel>
                                                        </MudTh>

                                                        @if (platform != "Linux")
                                                        {
                                                            <MudTh Style="white-space: nowrap;">
                                                                <MudTableSortLabel SortBy="new Func<Software_Installed_Entity, object>(x => x.installation_date)">@Localizer["installation_date"]</MudTableSortLabel>
                                                            </MudTh>
                                                            <MudTh Style="white-space: nowrap;">
                                                                <MudTableSortLabel SortBy="new Func<Software_Installed_Entity, object>(x => x.installation_path)">@Localizer["installation_path"]</MudTableSortLabel>
                                                            </MudTh>
                                                            <MudTh Style="white-space: nowrap;">
                                                                <MudTableSortLabel SortBy="new Func<Software_Installed_Entity, object>(x => x.vendor)">@Localizer["manufacturer"]</MudTableSortLabel>
                                                            </MudTh>
                                                        }

                                                        <MudTh Style="white-space: nowrap;">
                                                            <MudTableSortLabel SortBy="new Func<Software_Installed_Entity, object>(x => x.uninstallation_string)">@Localizer["uninstallation_command"]</MudTableSortLabel>
                                                        </MudTh>
                                                    </HeaderContent>
                                                    <RowTemplate Context="software_installed_row">

                                                        <MudTd DataLabel="Name" @onclick="() => Software_Installed_RowClickHandler(software_installed_row)" class="@Software_Installed_GetRowClass(software_installed_row)" style="white-space: nowrap;">
                                                             <span style="display: flex; align-items: center;">
                                                                &nbsp;@software_installed_row.name
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="Version" @onclick="() => Software_Installed_RowClickHandler(software_installed_row)" class="@Software_Installed_GetRowClass(software_installed_row)" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@software_installed_row.version
                                                            </span>
                                                        </MudTd>

                                                        @if (platform != "Linux")
                                                        {
                                                            <MudTd DataLabel="@Localizer["installation_date"]" @onclick="() => Software_Installed_RowClickHandler(software_installed_row)" class="@Software_Installed_GetRowClass(software_installed_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@software_installed_row.installation_date
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["installation_path"]" @onclick="() => Software_Installed_RowClickHandler(software_installed_row)" class="@Software_Installed_GetRowClass(software_installed_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@software_installed_row.installation_path
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["manufacturer"]" @onclick="() => Software_Installed_RowClickHandler(software_installed_row)" class="@Software_Installed_GetRowClass(software_installed_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@software_installed_row.vendor
                                                                </span>
                                                            </MudTd>
                                                        }

                                                        <MudTd DataLabel="@Localizer["uninstallation_command"]" @onclick="() => Software_Installed_RowClickHandler(software_installed_row)" class="@Software_Installed_GetRowClass(software_installed_row)" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@software_installed_row.uninstallation_string
                                                            </span>
                                                        </MudTd>

                                                    </RowTemplate>
                                                    <PagerContent>
                                                        <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                    </PagerContent>
                                                </MudTable>

                                            </MudPaper>

                                                <MudExpansionPanel Class="mt-5 custom-expansion-panel" @bind-Expanded="applications_installed_history_expanded" @bind-Expanded:after="async () => { await Applications_Installed_History_Table_Submit_Picker(); }">
                                                <TitleContent>
                                                    <div class="d-flex">
                                                        <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                        <MudText>@Localizer["history"]</MudText>
                                                    </div>
                                                </TitleContent>

                                                <ChildContent>

                                                    <div style="display: flex; align-items: center;">
                                                        <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="applications_installed_history_table_picker" @bind-DateRange="applications_installed_history_table_dateRange">
                                                            <PickerActions Context="pickerActionsContext">
                                                                <MudButton Class="mr-auto align-self-start" OnClick="@(() => applications_installed_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                <MudButton OnClick="@(() => applications_installed_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                <MudButton Color="Color.Primary" @onclick="async () => { await Applications_Installed_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                            </PickerActions>
                                                        </MudDateRangePicker>

                                                        <MudTooltip Text="@Localizer["export_data"]">
                                                            <MudIconButton Class="ml-2 mt-S" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default"  @onclick="Trigger_Export_Installed_Application_History_Table_Dialog"></MudIconButton>
                                                        </MudTooltip>
                                                    </div>

                                                    <MudTable Class="mt-2" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@applications_installed_history_mysql_data" GroupBy="@_groupDefinition" Filter="new Func<Applications_Installed_History_Entity, bool>(Applications_Installed_History_Table_Filter_Func)">
                                                        <ToolBarContent>
                                                            <MudTextField Class="mt-0" @bind-Value="applications_installed_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                        </ToolBarContent>
                                                        <HeaderContent>
                                                            <MudTh Sortable="true" @onclick="() => applications_installed_history_table_sorted_column = (nameof(Applications_Installed_History_Entity.name))" style="white-space: nowrap;">Name</MudTh>
                                                            <MudTh Sortable="true" @onclick="() => applications_installed_history_table_sorted_column = (nameof(Applications_Installed_History_Entity.version))" style="white-space: nowrap;">Version</MudTh>

                                                            @if (platform != "Linux")
                                                            {
                                                                <MudTh Sortable="true" @onclick="() => applications_installed_history_table_sorted_column = (nameof(Applications_Installed_History_Entity.installation_date))" style="white-space: nowrap;">@Localizer["installation_date"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_installed_history_table_sorted_column = (nameof(Applications_Installed_History_Entity.installation_path))" style="white-space: nowrap;">@Localizer["installation_path"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_installed_history_table_sorted_column = (nameof(Applications_Installed_History_Entity.vendor))" style="white-space: nowrap;">@Localizer["manufacturer"]</MudTh>
                                                            }

                                                            <MudTh Sortable="true" @onclick="() => applications_installed_history_table_sorted_column = (nameof(Applications_Installed_History_Entity.uninstallation_string))" style="white-space: nowrap;">@Localizer["uninstallation_command"]</MudTh>
                                                        </HeaderContent>
                                                        <GroupHeaderTemplate Context="groupContext">
                                                            <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                        </GroupHeaderTemplate>
                                                        <RowTemplate Context="applications_installed_history_row">

                                                            <MudTd DataLabel="Name" @onclick="() => Applications_Installed_History_RowClickHandler(applications_installed_history_row)" class="@Applications_Installed_History_GetRowClass(applications_installed_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_installed_history_row.name
                                                                </span>
                                                            </MudTd>
                                                            <MudTd DataLabel="Version" @onclick="() => Applications_Installed_History_RowClickHandler(applications_installed_history_row)" class="@Applications_Installed_History_GetRowClass(applications_installed_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_installed_history_row.version
                                                                </span>
                                                            </MudTd>

                                                            @if (platform != "Linux")
                                                            {
                                                                <MudTd DataLabel="@Localizer["installation_date"]" @onclick="() => Applications_Installed_History_RowClickHandler(applications_installed_history_row)" class="@Applications_Installed_History_GetRowClass(applications_installed_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_installed_history_row.installation_date
                                                                    </span>
                                                                </MudTd>
                                                                <MudTd DataLabel="@Localizer["installation_path"]" @onclick="() => Applications_Installed_History_RowClickHandler(applications_installed_history_row)" class="@Applications_Installed_History_GetRowClass(applications_installed_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_installed_history_row.installation_path
                                                                    </span>
                                                                </MudTd>
                                                                <MudTd DataLabel="@Localizer["manufacturer"]" @onclick="() => Applications_Installed_History_RowClickHandler(applications_installed_history_row)" class="@Applications_Installed_History_GetRowClass(applications_installed_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_installed_history_row.vendor
                                                                    </span>
                                                                </MudTd>
                                                            }

                                                            <MudTd DataLabel="@Localizer["uninstallation_command"]" @onclick="() => Applications_Installed_History_RowClickHandler(applications_installed_history_row)" class="@Applications_Installed_History_GetRowClass(applications_installed_history_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_installed_history_row.uninstallation_string
                                                                </span>
                                                            </MudTd>

                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>
                                                </ChildContent>
                                            </MudExpansionPanel>                            

                                        </MudTabPanel>

                                            @if (platform == "hideasplaceholder")
                                            {
                                                                    <MudTabPanel Text="@Localizer["Cronjobs"]">

                                                                    <MudPaper>

                                                                        <MudTooltip Text="@Localizer["export_data"]">
                                                                            <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Cronjobs_Table_Dialog"></MudIconButton>
                                                                        </MudTooltip>

                                                                        <MudTable Class="mt-0" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@cronjobs_mysql_data" Filter="new Func<Cronjobs_Entity, bool>(Cronjobs_Table_Filter_Func)">
                                                                            <ToolBarContent>
                                                                                <MudTextField @bind-Value="cronjobs_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                                            </ToolBarContent>
                                                                            <HeaderContent>
                                                                                <MudTh Style="white-space: nowrap;">
                                                                                    <MudTableSortLabel SortBy="new Func<Cronjobs_Entity, object>(x => x.name)">Name</MudTableSortLabel>
                                                                                </MudTh>
                                                                                <MudTh Style="white-space: nowrap;">
                                                                                    <MudTableSortLabel SortBy="new Func<Cronjobs_Entity, object>(x => x.version)">Version</MudTableSortLabel>
                                                                                </MudTh>
                                                                                <MudTh Style="white-space: nowrap;">
                                                                                    <MudTableSortLabel SortBy="new Func<Cronjobs_Entity, object>(x => x.installation_date)">@Localizer["installation_date"]</MudTableSortLabel>
                                                                                </MudTh>
                                                                                <MudTh Style="white-space: nowrap;">
                                                                                    <MudTableSortLabel SortBy="new Func<Cronjobs_Entity, object>(x => x.installation_path)">@Localizer["installation_path"]</MudTableSortLabel>
                                                                                </MudTh>
                                                                                <MudTh Style="white-space: nowrap;">
                                                                                    <MudTableSortLabel SortBy="new Func<Cronjobs_Entity, object>(x => x.vendor)">@Localizer["manufacturer"]</MudTableSortLabel>
                                                                                </MudTh>
                                                                                <MudTh Style="white-space: nowrap;">
                                                                                    <MudTableSortLabel SortBy="new Func<Cronjobs_Entity, object>(x => x.uninstallation_string)">@Localizer["uninstallation_command"]</MudTableSortLabel>
                                                                                </MudTh>
                                                                            </HeaderContent>
                                                                            <RowTemplate Context="cronjobs_row">

                                                                                <MudTd DataLabel="Name" @onclick="() => Cronjobs_RowClickHandler(cronjobs_row)" class="@Cronjobs_GetRowClass(cronjobs_row)" style="white-space: nowrap;">
                                                                                    <span style="display: flex; align-items: center;">
                                                                                        &nbsp;@cronjobs_row.name
                                                                                    </span>
                                                                                </MudTd>

                                                                                <MudTd DataLabel="Version" @onclick="() => Cronjobs_RowClickHandler(cronjobs_row)" class="@Cronjobs_GetRowClass(cronjobs_row)" style="white-space: nowrap;">
                                                                                    <span style="display: flex; align-items: center;">
                                                                                        &nbsp;@cronjobs_row.version
                                                                                    </span>
                                                                                </MudTd>

                                                                                <MudTd DataLabel="@Localizer["installation_date"]" @onclick="() => Cronjobs_RowClickHandler(cronjobs_row)" class="@Cronjobs_GetRowClass(cronjobs_row)" style="white-space: nowrap;">
                                                                                    <span style="display: flex; align-items: center;">
                                                                                        &nbsp;@cronjobs_row.installation_date
                                                                                    </span>
                                                                                </MudTd>

                                                                                <MudTd DataLabel="@Localizer["installation_path"]" @onclick="() => Cronjobs_RowClickHandler(cronjobs_row)" class="@Cronjobs_GetRowClass(cronjobs_row)" style="white-space: nowrap;">
                                                                                    <span style="display: flex; align-items: center;">
                                                                                        &nbsp;@cronjobs_row.installation_path
                                                                                    </span>
                                                                                </MudTd>

                                                                                <MudTd DataLabel="@Localizer["manufacturer"]" @onclick="() => Cronjobs_RowClickHandler(cronjobs_row)" class="@Cronjobs_GetRowClass(cronjobs_row)" style="white-space: nowrap;">
                                                                                    <span style="display: flex; align-items: center;">
                                                                                        &nbsp;@cronjobs_row.vendor
                                                                                    </span>
                                                                                </MudTd>

                                                                                <MudTd DataLabel="@Localizer["uninstallation_command"]" @onclick="() => Cronjobs_RowClickHandler(cronjobs_row)" class="@Cronjobs_GetRowClass(cronjobs_row)" style="white-space: nowrap;">
                                                                                    <span style="display: flex; align-items: center;">
                                                                                        &nbsp;@cronjobs_row.uninstallation_string
                                                                                    </span>
                                                                                </MudTd>

                                                                            </RowTemplate>
                                                                            <PagerContent>
                                                                                <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                                            </PagerContent>
                                                                        </MudTable>

                                                                    </MudPaper>

                                                                    <MudExpansionPanel Class="mt-5 custom-expansion-panel" @bind-Expanded="cronjobs_history_expanded" @bind-Expanded:after="async () => { await Cronjobs_History_Table_Submit_Picker(); }">
                                                                        <TitleContent>
                                                                            <div class="d-flex">
                                                                                <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                                                <MudText>@Localizer["history"]</MudText>
                                                                            </div>
                                                                        </TitleContent>

                                                                        <ChildContent>

                                                                            <div style="display: flex; align-items: center;">
                                                                                <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="cronjobs_history_table_picker" @bind-DateRange="cronjobs_history_table_dateRange">
                                                                                    <PickerActions Context="pickerActionsContext">
                                                                                        <MudButton Class="mr-auto align-self-start" OnClick="@(() => cronjobs_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                                        <MudButton OnClick="@(() => cronjobs_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                                        <MudButton Color="Color.Primary" @onclick="async () => { await Cronjobs_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                                                    </PickerActions>
                                                                                </MudDateRangePicker>

                                                                                <MudTooltip Text="@Localizer["export_data"]">
                                                                                    <MudIconButton Class="ml-2 mt-S" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Cronjobs_History_Table_Dialog"></MudIconButton>
                                                                                </MudTooltip>
                                                                            </div>

                                                                            <MudTable Class="mt-2" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@cronjobs_history_mysql_data" GroupBy="@cronjobs_groupDefinition" Filter="new Func<Cronjobs_History_Entity, bool>(Cronjobs_History_Table_Filter_Func)">
                                                                                <ToolBarContent>
                                                                                    <MudTextField Class="mt-0" @bind-Value="cronjobs_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                                                </ToolBarContent>
                                                                                <HeaderContent>
                                                                                    <MudTh Sortable="true" @onclick="() => cronjobs_history_table_sorted_column = (nameof(Cronjobs_History_Entity.name))" style="white-space: nowrap;">Name</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => cronjobs_history_table_sorted_column = (nameof(Cronjobs_History_Entity.version))" style="white-space: nowrap;">Version</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => cronjobs_history_table_sorted_column = (nameof(Cronjobs_History_Entity.installation_date))" style="white-space: nowrap;">@Localizer["installation_date"]</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => cronjobs_history_table_sorted_column = (nameof(Cronjobs_History_Entity.installation_path))" style="white-space: nowrap;">@Localizer["installation_path"]</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => cronjobs_history_table_sorted_column = (nameof(Cronjobs_History_Entity.vendor))" style="white-space: nowrap;">@Localizer["manufacturer"]</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => cronjobs_history_table_sorted_column = (nameof(Cronjobs_History_Entity.uninstallation_string))" style="white-space: nowrap;">@Localizer["uninstallation_command"]</MudTh>
                                                                                </HeaderContent>
                                                                                <GroupHeaderTemplate Context="groupContext">
                                                                                    <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                                                </GroupHeaderTemplate>
                                                                                <RowTemplate Context="cronjobs_history_row">

                                                                                    <MudTd DataLabel="Name" @onclick="() => Cronjobs_History_RowClickHandler(cronjobs_history_row)" class="@Cronjobs_History_GetRowClass(cronjobs_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@cronjobs_history_row.name
                                                                                        </span>
                                                                                    </MudTd>
                                                                                    <MudTd DataLabel="Version" @onclick="() => Cronjobs_History_RowClickHandler(cronjobs_history_row)" class="@Cronjobs_History_GetRowClass(cronjobs_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@cronjobs_history_row.version
                                                                                        </span>
                                                                                    </MudTd>
                                                                                    <MudTd DataLabel="@Localizer["installation_date"]" @onclick="() => Cronjobs_History_RowClickHandler(cronjobs_history_row)" class="@Cronjobs_History_GetRowClass(cronjobs_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@cronjobs_history_row.installation_date
                                                                                        </span>
                                                                                    </MudTd>
                                                                                    <MudTd DataLabel="@Localizer["installation_path"]" @onclick="() => Cronjobs_History_RowClickHandler(cronjobs_history_row)" class="@Cronjobs_History_GetRowClass(cronjobs_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@cronjobs_history_row.installation_path
                                                                                        </span>
                                                                                    </MudTd>
                                                                                    <MudTd DataLabel="@Localizer["manufacturer"]" @onclick="() => Cronjobs_History_RowClickHandler(cronjobs_history_row)" class="@Cronjobs_History_GetRowClass(cronjobs_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@cronjobs_history_row.vendor
                                                                                        </span>
                                                                                    </MudTd>
                                                                                    <MudTd DataLabel="@Localizer["uninstallation_command"]" @onclick="() => Cronjobs_History_RowClickHandler(cronjobs_history_row)" class="@Cronjobs_History_GetRowClass(cronjobs_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@cronjobs_history_row.uninstallation_string
                                                                                        </span>
                                                                                    </MudTd>

                                                                                </RowTemplate>
                                                                                <PagerContent>
                                                                                    <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                                                </PagerContent>
                                                                            </MudTable>
                                                                        </ChildContent>
                                                                    </MudExpansionPanel>

                                                                </MudTabPanel>
                                            }

                                        @if (platform == "Windows")
                                        {
                                            <MudTabPanel Text="Logon">
                                                <MudPaper>
                                                    <MudTooltip Text="@Localizer["export_data"]">
                                                        <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Application_Logon_Table_Dialog"></MudIconButton>
                                                    </MudTooltip>

                                                    <MudTable Class="mt-0" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@application_logon_mysql_data" Filter="new Func<Application_Logon_Entity, bool>(Application_Logon_Table_Filter_Func)">
                                                        <ToolBarContent>
                                                            <MudTextField @bind-Value="application_logon_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                        </ToolBarContent>
                                                        <HeaderContent>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Application_Logon_Entity, object>(x => x.name)">Name</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Application_Logon_Entity, object>(x => x.path)">@Localizer["path"]</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Application_Logon_Entity, object>(x => x.command)">@Localizer["command"]</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Application_Logon_Entity, object>(x => x.user)">@Localizer["user"]</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Application_Logon_Entity, object>(x => x.user_sid)">@Localizer["user_sid"]</MudTableSortLabel></MudTh>
                                                        </HeaderContent>

                                                        <RowTemplate Context="application_logon_row">

                                                            <MudTd DataLabel="Name" @onclick="() => Application_Logon_RowClickHandler(application_logon_row)" class="@Application_Logon_GetRowClass(application_logon_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@application_logon_row.name
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["path"]" @onclick="() => Application_Logon_RowClickHandler(application_logon_row)" class="@Application_Logon_GetRowClass(application_logon_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@application_logon_row.path
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["command"]" @onclick="() => Application_Logon_RowClickHandler(application_logon_row)" class="@Application_Logon_GetRowClass(application_logon_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@application_logon_row.command
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["user"]" @onclick="() => Application_Logon_RowClickHandler(application_logon_row)" class="@Application_Logon_GetRowClass(application_logon_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@application_logon_row.user
                                                                </span>
                                                            </MudTd>

                                                                <MudTd DataLabel="@Localizer["user_sid"]" @onclick="() => Application_Logon_RowClickHandler(application_logon_row)" class="@Application_Logon_GetRowClass(application_logon_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@application_logon_row.user_sid
                                                                </span>
                                                            </MudTd>

                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>

                                                </MudPaper>

                                                <MudExpansionPanel Class="mt-5 custom-expansion-panel" @bind-Expanded="applications_logon_history_expanded" @bind-Expanded:after="async () => { await Applications_Logon_History_Table_Submit_Picker(); }" >
                                                    <TitleContent>
                                                        <div class="d-flex">
                                                            <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                            <MudText>@Localizer["history"]</MudText>
                                                        </div>
                                                    </TitleContent>

                                                    <ChildContent>

                                                        <div style="display: flex; align-items: center;">
                                                            <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="applications_logon_history_table_picker" @bind-DateRange="applications_logon_history_table_dateRange">
                                                                <PickerActions Context="pickerActionsContext">
                                                                    <MudButton Class="mr-auto align-self-start" OnClick="@(() => applications_logon_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                    <MudButton OnClick="@(() => applications_logon_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                    <MudButton Color="Color.Primary" @onclick="async () => { await Applications_Logon_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                                </PickerActions>
                                                            </MudDateRangePicker>

                                                            <MudTooltip Text="@Localizer["export_data"]">
                                                                <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default"  @onclick="Trigger_Export_Application_Logon_History_Table_Dialog"></MudIconButton>
                                                            </MudTooltip>
                                                        </div>
                                        
                                                        <MudTable Class="mt-2i" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@applications_logon_history_mysql_data" GroupBy="@applications_logon_history_groupDefinition" Filter="new Func<Applications_Logon_History_Entity, bool>(Applications_Logon_History_Table_Filter_Func)">
                                                            <ToolBarContent>
                                                                <MudTextField Class="mt-0" @bind-Value="applications_logon_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                            </ToolBarContent>
                                                            <HeaderContent>
                                                                <MudTh Sortable="true" @onclick="() => applications_logon_history_table_sorted_column = (nameof(Applications_Logon_History_Entity.name))" style="white-space: nowrap;">Name</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_logon_history_table_sorted_column = (nameof(Applications_Logon_History_Entity.path))" style="white-space: nowrap;">@Localizer["path"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_logon_history_table_sorted_column = (nameof(Applications_Logon_History_Entity.command))" style="white-space: nowrap;">@Localizer["command"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_logon_history_table_sorted_column = (nameof(Applications_Logon_History_Entity.user))" style="white-space: nowrap;">@Localizer["user"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_logon_history_table_sorted_column = (nameof(Applications_Logon_History_Entity.user_sid))" style="white-space: nowrap;">@Localizer["user_sid"]</MudTh>
                                                            </HeaderContent>
                                                            <GroupHeaderTemplate Context="groupContext">
                                                                <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                            </GroupHeaderTemplate>
                                                            <RowTemplate Context="applications_logon_history_row">

                                                                <MudTd DataLabel="Name" @onclick="() => Applications_Logon_History_RowClickHandler(applications_logon_history_row)" class="@Applications_Logon_History_GetRowClass(applications_logon_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_logon_history_row.name
                                                                    </span>
                                                                </MudTd>
                                                                    <MudTd DataLabel="@Localizer["path"]" @onclick="() => Applications_Logon_History_RowClickHandler(applications_logon_history_row)" class="@Applications_Logon_History_GetRowClass(applications_logon_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_logon_history_row.path
                                                                    </span>
                                                                </MudTd>
                                                                <MudTd DataLabel="@Localizer["command"]" @onclick="() => Applications_Logon_History_RowClickHandler(applications_logon_history_row)" class="@Applications_Logon_History_GetRowClass(applications_logon_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_logon_history_row.command
                                                                    </span>
                                                                </MudTd>
                                                                <MudTd DataLabel="@Localizer["user"]" @onclick="() => Applications_Logon_History_RowClickHandler(applications_logon_history_row)" class="@Applications_Logon_History_GetRowClass(applications_logon_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_logon_history_row.user
                                                                    </span>
                                                                </MudTd>
                                                                    <MudTd DataLabel="@Localizer["user_sid"]" @onclick="() => Applications_Logon_History_RowClickHandler(applications_logon_history_row)" class="@Applications_Logon_History_GetRowClass(applications_logon_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_logon_history_row.user_sid
                                                                    </span>
                                                                </MudTd>

                                                            </RowTemplate>
                                                            <PagerContent>
                                                                <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                            </PagerContent>
                                                        </MudTable>
                                                    </ChildContent>
                                                </MudExpansionPanel> 

                                            </MudTabPanel>
                                        }

                                        @if (platform == "Windows")
                                        {
                                            <MudTabPanel Text="@Localizer["task_scheduler"]">
                                                <MudPaper>

                                                    <MudTooltip Text="@Localizer["export_data"]">
                                                        <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Application_Scheduled_Tasks_Table_Dialog"></MudIconButton>
                                                    </MudTooltip>

                                                    <MudTable Class="mt-0" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@applications_scheduled_tasks_mysql_data" Filter="new Func<Applications_Scheduled_Tasks_Entity, bool>(Applications_Scheduled_Tasks_Table_Filter_Func)">
                                                        <ToolBarContent>
                                                            <MudTextField @bind-Value="applications_scheduled_tasks_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                        </ToolBarContent>
                                                        <HeaderContent>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Scheduled_Tasks_Entity, object>(x => x.name)">Name</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Scheduled_Tasks_Entity, object>(x => x.status)">Status</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Scheduled_Tasks_Entity, object>(x => x.author)">@Localizer["author"]</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Scheduled_Tasks_Entity, object>(x => x.path)">@Localizer["path"]</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Scheduled_Tasks_Entity, object>(x => x.folder)">@Localizer["directory"]</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Scheduled_Tasks_Entity, object>(x => x.user_sid)">@Localizer["user_sid"]</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Scheduled_Tasks_Entity, object>(x => x.next_execution)">@Localizer["next_execution"]</MudTableSortLabel></MudTh>
                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Scheduled_Tasks_Entity, object>(x => x.last_execution)">@Localizer["last_execution"]</MudTableSortLabel></MudTh>
                                                        </HeaderContent>
                                                        <RowTemplate Context="applications_scheduled_tasks_row">

                                                            <MudTd DataLabel="Name" @onclick="() => Applications_Scheduled_Tasks_RowClickHandler(applications_scheduled_tasks_row)" class="@Applications_Scheduled_Tasks_GetRowClass(applications_scheduled_tasks_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_scheduled_tasks_row.name
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="Status" @onclick="() => Applications_Scheduled_Tasks_RowClickHandler(applications_scheduled_tasks_row)" class="@Applications_Scheduled_Tasks_GetRowClass(applications_scheduled_tasks_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_scheduled_tasks_row.status
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["author"]" @onclick="() => Applications_Scheduled_Tasks_RowClickHandler(applications_scheduled_tasks_row)" class="@Applications_Scheduled_Tasks_GetRowClass(applications_scheduled_tasks_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_scheduled_tasks_row.author
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["path"]" @onclick="() => Applications_Scheduled_Tasks_RowClickHandler(applications_scheduled_tasks_row)" class="@Applications_Scheduled_Tasks_GetRowClass(applications_scheduled_tasks_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_scheduled_tasks_row.path
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["directory"]" @onclick="() => Applications_Scheduled_Tasks_RowClickHandler(applications_scheduled_tasks_row)" class="@Applications_Scheduled_Tasks_GetRowClass(applications_scheduled_tasks_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_scheduled_tasks_row.folder
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["user_sid"]" @onclick="() => Applications_Scheduled_Tasks_RowClickHandler(applications_scheduled_tasks_row)" class="@Applications_Scheduled_Tasks_GetRowClass(applications_scheduled_tasks_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_scheduled_tasks_row.user_sid
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["next_execution"]" @onclick="() => Applications_Scheduled_Tasks_RowClickHandler(applications_scheduled_tasks_row)" class="@Applications_Scheduled_Tasks_GetRowClass(applications_scheduled_tasks_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_scheduled_tasks_row.next_execution
                                                                </span>
                                                            </MudTd>

                                                            <MudTd DataLabel="@Localizer["last_execution"]" @onclick="() => Applications_Scheduled_Tasks_RowClickHandler(applications_scheduled_tasks_row)" class="@Applications_Scheduled_Tasks_GetRowClass(applications_scheduled_tasks_row)" style="white-space: nowrap;">
                                                                <span style="display: flex; align-items: center;">
                                                                    &nbsp;@applications_scheduled_tasks_row.last_execution
                                                                </span>
                                                            </MudTd>

                                                        </RowTemplate>
                                                        <PagerContent>
                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                        </PagerContent>
                                                    </MudTable>

                                                </MudPaper>

                                                <MudExpansionPanel Class="mt-5 custom-expansion-panel" @bind-Expanded="applications_scheduled_tasks_history_expanded" @bind-Expanded:after="async () => { await Applications_Scheduled_Tasks_History_Table_Submit_Picker(); }" >
                                                    <TitleContent>
                                                        <div class="d-flex">
                                                            <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                            <MudText>@Localizer["history"]</MudText>
                                                        </div>
                                                    </TitleContent>

                                                    <ChildContent>
                                                
                                                            <div style="display: flex; align-items: center;">
                                                                <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="applications_scheduled_tasks_history_table_picker" @bind-DateRange="applications_scheduled_tasks_history_table_dateRange">
                                                                    <PickerActions Context="pickerActionsContext">
                                                                        <MudButton Class="mr-auto align-self-start" OnClick="@(() => applications_scheduled_tasks_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                        <MudButton OnClick="@(() => applications_scheduled_tasks_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                        <MudButton Color="Color.Primary" @onclick="async () => { await Applications_Scheduled_Tasks_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                                    </PickerActions>
                                                                </MudDateRangePicker>

                                                                <MudTooltip Text="@Localizer["export_data"]">
                                                                    <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default"  @onclick="Trigger_Export_Application_Scheduled_Tasks_History_Table_Dialog"></MudIconButton>
                                                                </MudTooltip>
                                                            </div>

                                                            <MudTable Class="mt-2" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@applications_scheduled_tasks_history_mysql_data" GroupBy="@applications_scheduled_tasks_history_groupDefinition" Filter="new Func<Applications_Scheduled_Tasks_History_Entity, bool>(Applications_Scheduled_Tasks_History_Table_Filter_Func)">
                                                                <ToolBarContent>
                                                                    <MudTextField Class="mt-0" @bind-Value="applications_scheduled_tasks_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                                </ToolBarContent>
                                                                <HeaderContent>
                                                                    <MudTh Sortable="true" @onclick="() => applications_scheduled_tasks_history_table_sorted_column = (nameof(Applications_Scheduled_Tasks_History_Entity.name))" style="white-space: nowrap;">Name</MudTh>
                                                                    <MudTh Sortable="true" @onclick="() => applications_scheduled_tasks_history_table_sorted_column = (nameof(Applications_Scheduled_Tasks_History_Entity.status))" style="white-space: nowrap;">Status</MudTh>
                                                                    <MudTh Sortable="true" @onclick="() => applications_scheduled_tasks_history_table_sorted_column = (nameof(Applications_Scheduled_Tasks_History_Entity.author))" style="white-space: nowrap;">@Localizer["author"]</MudTh>
                                                                    <MudTh Sortable="true" @onclick="() => applications_scheduled_tasks_history_table_sorted_column = (nameof(Applications_Scheduled_Tasks_History_Entity.path))" style="white-space: nowrap;">@Localizer["path"]</MudTh>
                                                                    <MudTh Sortable="true" @onclick="() => applications_scheduled_tasks_history_table_sorted_column = (nameof(Applications_Scheduled_Tasks_History_Entity.folder))" style="white-space: nowrap;">@Localizer["directory"]</MudTh>
                                                                    <MudTh Sortable="true" @onclick="() => applications_scheduled_tasks_history_table_sorted_column = (nameof(Applications_Scheduled_Tasks_History_Entity.user_sid))" style="white-space: nowrap;">@Localizer["user_sid"]</MudTh>
                                                                    <MudTh Sortable="true" @onclick="() => applications_scheduled_tasks_history_table_sorted_column = (nameof(Applications_Scheduled_Tasks_History_Entity.next_execution))" style="white-space: nowrap;">@Localizer["next_execution"]</MudTh>
                                                                    <MudTh Sortable="true" @onclick="() => applications_scheduled_tasks_history_table_sorted_column = (nameof(Applications_Scheduled_Tasks_History_Entity.last_execution))" style="white-space: nowrap;">@Localizer["last_execution"]</MudTh>
                                                                </HeaderContent>
                                                                <GroupHeaderTemplate Context="groupContext">
                                                                    <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                                </GroupHeaderTemplate>
                                                                <RowTemplate Context="applications_scheduled_tasks_history_row">

                                                                    <MudTd DataLabel="Name" @onclick="() => Applications_Scheduled_Tasks_History_RowClickHandler(applications_scheduled_tasks_history_row)" class="@Applications_Scheduled_Tasks_History_GetRowClass(applications_scheduled_tasks_history_row)" style="white-space: nowrap;">
                                                                        <span style="display: flex; align-items: center;">
                                                                            &nbsp;@applications_scheduled_tasks_history_row.name
                                                                        </span>
                                                                    </MudTd>
                                                                    <MudTd DataLabel="Status" @onclick="() => Applications_Scheduled_Tasks_History_RowClickHandler(applications_scheduled_tasks_history_row)" class="@Applications_Scheduled_Tasks_History_GetRowClass(applications_scheduled_tasks_history_row)" style="white-space: nowrap;">
                                                                        <span style="display: flex; align-items: center;">
                                                                            &nbsp;@applications_scheduled_tasks_history_row.status
                                                                        </span>
                                                                    </MudTd>
                                                                    <MudTd DataLabel="@Localizer["author"]" @onclick="() => Applications_Scheduled_Tasks_History_RowClickHandler(applications_scheduled_tasks_history_row)" class="@Applications_Scheduled_Tasks_History_GetRowClass(applications_scheduled_tasks_history_row)" style="white-space: nowrap;">
                                                                        <span style="display: flex; align-items: center;">
                                                                            &nbsp;@applications_scheduled_tasks_history_row.author
                                                                        </span>
                                                                    </MudTd>
                                                                    <MudTd DataLabel="@Localizer["path"]" @onclick="() => Applications_Scheduled_Tasks_History_RowClickHandler(applications_scheduled_tasks_history_row)" class="@Applications_Scheduled_Tasks_History_GetRowClass(applications_scheduled_tasks_history_row)" style="white-space: nowrap;">
                                                                        <span style="display: flex; align-items: center;">
                                                                            &nbsp;@applications_scheduled_tasks_history_row.path
                                                                        </span>
                                                                    </MudTd>
                                                                    <MudTd DataLabel="@Localizer["directory"]" @onclick="() => Applications_Scheduled_Tasks_History_RowClickHandler(applications_scheduled_tasks_history_row)" class="@Applications_Scheduled_Tasks_History_GetRowClass(applications_scheduled_tasks_history_row)" style="white-space: nowrap;">
                                                                        <span style="display: flex; align-items: center;">
                                                                            &nbsp;@applications_scheduled_tasks_history_row.folder
                                                                        </span>
                                                                    </MudTd>
                                                                    <MudTd DataLabel="@Localizer["user_sid"]" @onclick="() => Applications_Scheduled_Tasks_History_RowClickHandler(applications_scheduled_tasks_history_row)" class="@Applications_Scheduled_Tasks_History_GetRowClass(applications_scheduled_tasks_history_row)" style="white-space: nowrap;">
                                                                        <span style="display: flex; align-items: center;">
                                                                            &nbsp;@applications_scheduled_tasks_history_row.user_sid
                                                                        </span>
                                                                    </MudTd>
                                                                    <MudTd DataLabel="@Localizer["next_execution"]" @onclick="() => Applications_Scheduled_Tasks_History_RowClickHandler(applications_scheduled_tasks_history_row)" class="@Applications_Scheduled_Tasks_History_GetRowClass(applications_scheduled_tasks_history_row)" style="white-space: nowrap;">
                                                                        <span style="display: flex; align-items: center;">
                                                                            &nbsp;@applications_scheduled_tasks_history_row.next_execution
                                                                        </span>
                                                                    </MudTd>
                                                                    <MudTd DataLabel="@Localizer["last_execution"]" @onclick="() => Applications_Scheduled_Tasks_History_RowClickHandler(applications_scheduled_tasks_history_row)" class="@Applications_Scheduled_Tasks_History_GetRowClass(applications_scheduled_tasks_history_row)" style="white-space: nowrap;">
                                                                        <span style="display: flex; align-items: center;">
                                                                            &nbsp;@applications_scheduled_tasks_history_row.last_execution
                                                                        </span>
                                                                    </MudTd>


                                                                </RowTemplate>
                                                                <PagerContent>
                                                                    <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                                </PagerContent>
                                                            </MudTable>
                                                    </ChildContent>
                                                </MudExpansionPanel>
                                            </MudTabPanel>
                                        }

                                        <MudTabPanel Text="@Localizer["services"]">
                                            <MudPaper>

                                                <MudButton Class="ml-2 mt-2" Size="Size.Small" Color="Color.Default" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Info" @onclick="@(() => Remote_Service_Action("status", applications_services_selectedRowContent))" Disabled="@(String.IsNullOrEmpty(applications_services_selectedRowContent))">@Localizer["status"]</MudButton>
                                                <MudButton Class="ml-2 mt-2" Size="Size.Small" Color="Color.Default" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.PlayArrow" @onclick="@(() => Remote_Service_Action("start", applications_services_selectedRowContent))" Disabled="@(String.IsNullOrEmpty(applications_services_selectedRowContent))">@Localizer["start"]</MudButton>
                                                <MudButton Class="ml-2 mt-2" Size="Size.Small" Color="Color.Default" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Stop" @onclick="@(() => Remote_Service_Action("stop", applications_services_selectedRowContent))" Disabled="@(String.IsNullOrEmpty(applications_services_selectedRowContent))">@Localizer["stop"]</MudButton>
                                                <MudButton Class="ml-2 mt-2" Size="Size.Small" Color="Color.Default" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.RestartAlt" @onclick="@(() => Remote_Service_Action("restart", applications_services_selectedRowContent))" Disabled="@(String.IsNullOrEmpty(applications_services_selectedRowContent))">@Localizer["restart"]</MudButton>
                                        
                                                <MudTooltip Text="@Localizer["export_data"]">
                                                    <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Applications_Services_Table_Dialog"></MudIconButton>
                                                </MudTooltip>

                                                <MudTable Class="mt-0" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true"  RowsPerPage="@applications_services_table_rowsPerPage" RowsPerPageChanged="@((int val) => applications_services_table_rowsPerPage = val)" CurrentPage="@applications_services_table_currentPage" CurrentPageChanged="@((int val) => applications_services_table_currentPage = val)"  Dense="true" Items="@applications_services_mysql_data" Filter="new Func<Applications_Services_Entity, bool>(Applications_Services_Table_Filter_Func)">
                                                    <ToolBarContent>
                                                        <MudTextField @bind-Value="applications_services_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                    </ToolBarContent>
                                                    <HeaderContent>
                                                        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Services_Entity, object>(x => x.display_name)">@Localizer["display_name"]</MudTableSortLabel></MudTh>
                                                        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Services_Entity, object>(x => x.name)">@Localizer["service_name"]</MudTableSortLabel></MudTh>
                                                        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Services_Entity, object>(x => x.status)">Status</MudTableSortLabel></MudTh>
                                                        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Services_Entity, object>(x => x.start_type)">@Localizer["start_type"]</MudTableSortLabel></MudTh>
                                                        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Services_Entity, object>(x => x.login_as)">@Localizer["login_as"]</MudTableSortLabel></MudTh>
                                                        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Services_Entity, object>(x => x.path)">@Localizer["path"]</MudTableSortLabel></MudTh>
                                                        <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Services_Entity, object>(x => x.description)">@Localizer["description"]</MudTableSortLabel></MudTh>
                                                    </HeaderContent>
                                                    <RowTemplate Context="applications_services_row">

                                                        <MudTd DataLabel="@Localizer["display_name"]" @onclick="() => Applications_Services_RowClickHandler(applications_services_row)" class="@Applications_Services_GetRowClass(applications_services_row)" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@applications_services_row.display_name
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["service_name"]" @onclick="() => Applications_Services_RowClickHandler(applications_services_row)" class="@Applications_Services_GetRowClass(applications_services_row)" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@applications_services_row.name
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="Status" @onclick="() => Applications_Services_RowClickHandler(applications_services_row)" class="@Applications_Services_GetRowClass(applications_services_row)" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@applications_services_row.status
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["start_type"]" @onclick="() => Applications_Services_RowClickHandler(applications_services_row)" class="@Applications_Services_GetRowClass(applications_services_row)" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@applications_services_row.start_type
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["login_as"]" @onclick="() => Applications_Services_RowClickHandler(applications_services_row)" class="@Applications_Services_GetRowClass(applications_services_row)" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@applications_services_row.login_as
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["path"]" @onclick="() => Applications_Services_RowClickHandler(applications_services_row)" class="@Applications_Services_GetRowClass(applications_services_row)" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@applications_services_row.path
                                                            </span>
                                                        </MudTd>

                                                        <MudTd DataLabel="@Localizer["description"]" @onclick="() => Applications_Services_RowClickHandler(applications_services_row)" class="@Applications_Services_GetRowClass(applications_services_row)" style="white-space: nowrap;">
                                                            <span style="display: flex; align-items: center;">
                                                                &nbsp;@applications_services_row.description
                                                            </span>
                                                        </MudTd>

                                                    </RowTemplate>
                                                    <PagerContent>
                                                        <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                    </PagerContent>
                                                </MudTable>
                                            
                                            </MudPaper>

                                            <MudExpansionPanel Class="mt-5 custom-expansion-panel" @bind-Expanded="applications_services_history_expanded" @bind-Expanded:after="async () => { await Applications_Services_History_Table_Submit_Picker(); }">
                                                <TitleContent>
                                                    <div class="d-flex">
                                                        <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                        <MudText>@Localizer["history"]</MudText>
                                                    </div>
                                                </TitleContent>

                                                <ChildContent>

                                                        <div style="display: flex; align-items: center;">
                                                            <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="applications_services_history_table_picker" @bind-DateRange="applications_services_history_table_dateRange">
                                                                <PickerActions Context="pickerActionsContext">
                                                                    <MudButton Class="mr-auto align-self-start" OnClick="@(() => applications_services_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                    <MudButton OnClick="@(() => applications_services_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                    <MudButton Color="Color.Primary" @onclick="async () => { await Applications_Services_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                                </PickerActions>
                                                            </MudDateRangePicker>

                                                            <MudTooltip Text="@Localizer["export_data"]">
                                                                <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default"  @onclick="Trigger_Export_Application_Services_History_Table_Dialog"></MudIconButton>
                                                            </MudTooltip>
                                                        </div>

                                                        <MudTable Class="mt-2" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@applications_services_history_mysql_data" GroupBy="@applications_services_history_groupDefinition" Filter="new Func<Applications_Services_History_Entity, bool>(Applications_Services_History_Table_Filter_Func)">
                                                            <ToolBarContent>
                                                                <MudTextField Class="mt-0" @bind-Value="applications_services_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                            </ToolBarContent>
                                                            <HeaderContent>
                                                                <MudTh Sortable="true" @onclick="() => applications_services_history_table_sorted_column = (nameof(Applications_Services_History_Entity.display_name))" style="white-space: nowrap;">@Localizer["display_name"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_services_history_table_sorted_column = (nameof(Applications_Services_History_Entity.name))" style="white-space: nowrap;">@Localizer["service_name"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_services_history_table_sorted_column = (nameof(Applications_Services_History_Entity.status))" style="white-space: nowrap;">Status</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_services_history_table_sorted_column = (nameof(Applications_Services_History_Entity.start_type))" style="white-space: nowrap;">@Localizer["start_type"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_services_history_table_sorted_column = (nameof(Applications_Services_History_Entity.login_as))" style="white-space: nowrap;">@Localizer["login_as"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_services_history_table_sorted_column = (nameof(Applications_Services_History_Entity.path))" style="white-space: nowrap;">@Localizer["path"]</MudTh>
                                                                <MudTh Sortable="true" @onclick="() => applications_services_history_table_sorted_column = (nameof(Applications_Services_History_Entity.description))" style="white-space: nowrap;">@Localizer["description"]</MudTh>
                                                            </HeaderContent>
                                                            <GroupHeaderTemplate Context="groupContext">
                                                                <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                            </GroupHeaderTemplate>
                                                            <RowTemplate Context="applications_services_history_row">

                                                                <MudTd DataLabel="@Localizer["display_name"]" @onclick="() => Applications_Services_History_RowClickHandler(applications_services_history_row)" class="@Applications_Services_History_GetRowClass(applications_services_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_services_history_row.display_name
                                                                    </span>
                                                                </MudTd>
                                                                <MudTd DataLabel="@Localizer["service_name"]" @onclick="() => Applications_Services_History_RowClickHandler(applications_services_history_row)" class="@Applications_Services_History_GetRowClass(applications_services_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_services_history_row.name
                                                                    </span>
                                                                </MudTd>

                                                                <MudTd DataLabel="Status" @onclick="() => Applications_Services_History_RowClickHandler(applications_services_history_row)" class="@Applications_Services_History_GetRowClass(applications_services_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_services_history_row.status
                                                                    </span>
                                                                </MudTd>
                                                                <MudTd DataLabel="@Localizer["start_type"]" @onclick="() => Applications_Services_History_RowClickHandler(applications_services_history_row)" class="@Applications_Services_History_GetRowClass(applications_services_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_services_history_row.start_type
                                                                    </span>
                                                                </MudTd>
                                                                <MudTd DataLabel="@Localizer["login_as"]" @onclick="() => Applications_Services_History_RowClickHandler(applications_services_history_row)" class="@Applications_Services_History_GetRowClass(applications_services_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_services_history_row.login_as
                                                                    </span>
                                                                </MudTd>
                                                                <MudTd DataLabel="@Localizer["path"]" @onclick="() => Applications_Services_History_RowClickHandler(applications_services_history_row)" class="@Applications_Services_History_GetRowClass(applications_services_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_services_history_row.path
                                                                    </span>
                                                                </MudTd>
                                                                <MudTd DataLabel="@Localizer["description"]" @onclick="() => Applications_Services_History_RowClickHandler(applications_services_history_row)" class="@Applications_Services_History_GetRowClass(applications_services_history_row)" style="white-space: nowrap;">
                                                                    <span style="display: flex; align-items: center;">
                                                                        &nbsp;@applications_services_history_row.description
                                                                    </span>
                                                                </MudTd>

                                                            </RowTemplate>
                                                            <PagerContent>
                                                                <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                            </PagerContent>
                                                        </MudTable>
                                                </ChildContent>
                                            </MudExpansionPanel>
                                        </MudTabPanel>

                                        @if (platform == "Windows")
                                        {
                                                                <MudTabPanel Text="@Localizer["drivers"]">
                                                                <MudPaper>

                                                                    <MudTooltip Text="@Localizer["export_data"]">
                                                                        <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Applications_Drivers_Table_Dialog"></MudIconButton>
                                                                    </MudTooltip>

                                                                    <MudTable Class="mt-0" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@applications_drivers_mysql_data" Filter="new Func<Applications_Drivers_Entity, bool>(Applications_Drivers_Table_Filter_Func)">
                                                                        <ToolBarContent>
                                                                            <MudTextField @bind-Value="applications_drivers_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                                        </ToolBarContent>
                                                                        <HeaderContent>
                                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Drivers_Entity, object>(x => x.display_name)">@Localizer["display_name"]</MudTableSortLabel></MudTh>
                                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Drivers_Entity, object>(x => x.name)">Name</MudTableSortLabel></MudTh>
                                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Drivers_Entity, object>(x => x.description)">@Localizer["description"]</MudTableSortLabel></MudTh>
                                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Drivers_Entity, object>(x => x.status)">Status</MudTableSortLabel></MudTh>
                                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Drivers_Entity, object>(x => x.type)">@Localizer["type"]</MudTableSortLabel></MudTh>
                                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Drivers_Entity, object>(x => x.start_type)">@Localizer["start_type"]</MudTableSortLabel></MudTh>
                                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Drivers_Entity, object>(x => x.path)">@Localizer["path"]</MudTableSortLabel></MudTh>
                                                                            <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Applications_Drivers_Entity, object>(x => x.version)">Version</MudTableSortLabel></MudTh>
                                                                        </HeaderContent>
                                                                        <RowTemplate Context="applications_drivers_row">

                                                                            <MudTd DataLabel="@Localizer["display_name"]" @onclick="() => Applications_Drivers_RowClickHandler(applications_drivers_row)" class="@Applications_Drivers_GetRowClass(applications_drivers_row)" style="white-space: nowrap;">
                                                                                <span style="display: flex; align-items: center;">
                                                                                    &nbsp;@applications_drivers_row.display_name
                                                                                </span>
                                                                            </MudTd>

                                                                            <MudTd DataLabel="Name" @onclick="() => Applications_Drivers_RowClickHandler(applications_drivers_row)" class="@Applications_Drivers_GetRowClass(applications_drivers_row)" style="white-space: nowrap;">
                                                                                <span style="display: flex; align-items: center;">
                                                                                    &nbsp;@applications_drivers_row.name
                                                                                </span>
                                                                            </MudTd>

                                                                            <MudTd DataLabel="@Localizer["description"]" @onclick="() => Applications_Drivers_RowClickHandler(applications_drivers_row)" class="@Applications_Drivers_GetRowClass(applications_drivers_row)" style="white-space: nowrap;">
                                                                                <span style="display: flex; align-items: center;">
                                                                                    &nbsp;@applications_drivers_row.description
                                                                                </span>
                                                                            </MudTd>

                                                                            <MudTd DataLabel="Status" @onclick="() => Applications_Drivers_RowClickHandler(applications_drivers_row)" class="@Applications_Drivers_GetRowClass(applications_drivers_row)" style="white-space: nowrap;">
                                                                                <span style="display: flex; align-items: center;">
                                                                                    &nbsp;@applications_drivers_row.status
                                                                                </span>
                                                                            </MudTd>

                                                                            <MudTd DataLabel="@Localizer["type"]" @onclick="() => Applications_Drivers_RowClickHandler(applications_drivers_row)" class="@Applications_Drivers_GetRowClass(applications_drivers_row)" style="white-space: nowrap;">
                                                                                <span style="display: flex; align-items: center;">
                                                                                    &nbsp;@applications_drivers_row.type
                                                                                </span>
                                                                            </MudTd>

                                                                            <MudTd DataLabel="@Localizer["start_type"]" @onclick="() => Applications_Drivers_RowClickHandler(applications_drivers_row)" class="@Applications_Drivers_GetRowClass(applications_drivers_row)" style="white-space: nowrap;">
                                                                                <span style="display: flex; align-items: center;">
                                                                                    &nbsp;@applications_drivers_row.start_type
                                                                                </span>
                                                                            </MudTd>

                                                                            <MudTd DataLabel="@Localizer["path"]" @onclick="() => Applications_Drivers_RowClickHandler(applications_drivers_row)" class="@Applications_Drivers_GetRowClass(applications_drivers_row)" style="white-space: nowrap;">
                                                                                <span style="display: flex; align-items: center;">
                                                                                    &nbsp;@applications_drivers_row.path
                                                                                </span>
                                                                            </MudTd>

                                                                            <MudTd DataLabel="Version" @onclick="() => Applications_Drivers_RowClickHandler(applications_drivers_row)" class="@Applications_Drivers_GetRowClass(applications_drivers_row)" style="white-space: nowrap;">
                                                                                <span style="display: flex; align-items: center;">
                                                                                    &nbsp;@applications_drivers_row.version
                                                                                </span>
                                                                            </MudTd>

                                                                        </RowTemplate>
                                                                        <PagerContent>
                                                                            <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                                        </PagerContent>
                                                                    </MudTable>

                                                                </MudPaper>

                                                                <MudExpansionPanel Class="mt-5 custom-expansion-panel" @bind-Expanded="applications_drivers_history_expanded" @bind-Expanded:after="async () => { await Applications_Drivers_History_Table_Submit_Picker(); }">
                                                                    <TitleContent>
                                                                        <div class="d-flex">
                                                                            <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                                            <MudText>@Localizer["history"]</MudText>
                                                                        </div>
                                                                    </TitleContent>

                                                                    <ChildContent>
                                                                            <div style="display: flex; align-items: center;">
                                                                                <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="applications_drivers_history_table_picker" @bind-DateRange="applications_drivers_history_table_dateRange"    >
                                                                                    <PickerActions Context="pickerActionsContext">
                                                                                        <MudButton Class="mr-auto align-self-start" OnClick="@(() => applications_drivers_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                                                        <MudButton OnClick="@(() => applications_drivers_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                                                        <MudButton Color="Color.Primary" @onclick="async () => { await Applications_Drivers_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                                                    </PickerActions>
                                                                                </MudDateRangePicker>

                                                                                <MudTooltip Text="@Localizer["export_data"]">
                                                                                    <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default"  @onclick="Trigger_Export_Application_Drivers_History_Table_Dialog"></MudIconButton>
                                                                                </MudTooltip>
                                                                            </div>

                                                                            <MudTable Class="mt-5" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@applications_drivers_history_mysql_data" GroupBy="@applications_drivers_history_groupDefinition" Filter="new Func<Applications_Drivers_History_Entity, bool>(Applications_Drivers_History_Table_Filter_Func)">
                                                                                <ToolBarContent>
                                                                                    <MudTextField Class="mt-0" @bind-Value="applications_drivers_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                                                </ToolBarContent>
                                                                                <HeaderContent>
                                                                                    <MudTh Sortable="true" @onclick="() => applications_drivers_history_table_sorted_column = (nameof(Applications_Drivers_History_Entity.display_name))" style="white-space: nowrap;">@Localizer["display_name"]</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => applications_drivers_history_table_sorted_column = (nameof(Applications_Drivers_History_Entity.name))" style="white-space: nowrap;">Name</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => applications_drivers_history_table_sorted_column = (nameof(Applications_Drivers_History_Entity.description))" style="white-space: nowrap;">@Localizer["description"]</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => applications_drivers_history_table_sorted_column = (nameof(Applications_Drivers_History_Entity.status))" style="white-space: nowrap;">Status</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => applications_drivers_history_table_sorted_column = (nameof(Applications_Drivers_History_Entity.type))" style="white-space: nowrap;">@Localizer["type"]</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => applications_drivers_history_table_sorted_column = (nameof(Applications_Drivers_History_Entity.start_type))" style="white-space: nowrap;">@Localizer["start_type"]</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => applications_drivers_history_table_sorted_column = (nameof(Applications_Drivers_History_Entity.path))" style="white-space: nowrap;">@Localizer["path"]</MudTh>
                                                                                    <MudTh Sortable="true" @onclick="() => applications_drivers_history_table_sorted_column = (nameof(Applications_Drivers_History_Entity.version))" style="white-space: nowrap;">Version</MudTh>
                                                                                </HeaderContent>
                                                                                <GroupHeaderTemplate Context="groupContext">
                                                                                    <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                                                </GroupHeaderTemplate>
                                                                                <RowTemplate Context="applications_drivers_history_row">

                                                                                    <MudTd DataLabel="@Localizer["display_name"]" @onclick="() => Applications_Drivers_History_RowClickHandler(applications_drivers_history_row)" class="@Applications_Drivers_History_GetRowClass(applications_drivers_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@applications_drivers_history_row.display_name
                                                                                        </span>
                                                                                    </MudTd>
                                                                                    <MudTd DataLabel="Name" @onclick="() => Applications_Drivers_History_RowClickHandler(applications_drivers_history_row)" class="@Applications_Drivers_History_GetRowClass(applications_drivers_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@applications_drivers_history_row.name
                                                                                        </span>
                                                                                    </MudTd>

                                                                                    <MudTd DataLabel="@Localizer["description"]" @onclick="() => Applications_Drivers_History_RowClickHandler(applications_drivers_history_row)" class="@Applications_Drivers_History_GetRowClass(applications_drivers_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@applications_drivers_history_row.description
                                                                                        </span>
                                                                                    </MudTd>

                                                                                    <MudTd DataLabel="Status" @onclick="() => Applications_Drivers_History_RowClickHandler(applications_drivers_history_row)" class="@Applications_Drivers_History_GetRowClass(applications_drivers_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@applications_drivers_history_row.status
                                                                                        </span>
                                                                                    </MudTd>

                                                                                    <MudTd DataLabel="@Localizer["type"]" @onclick="() => Applications_Drivers_History_RowClickHandler(applications_drivers_history_row)" class="@Applications_Drivers_History_GetRowClass(applications_drivers_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@applications_drivers_history_row.type
                                                                                        </span>
                                                                                    </MudTd>

                                                                                    <MudTd DataLabel="@Localizer["start_type"]" @onclick="() => Applications_Drivers_History_RowClickHandler(applications_drivers_history_row)" class="@Applications_Drivers_History_GetRowClass(applications_drivers_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@applications_drivers_history_row.start_type
                                                                                        </span>
                                                                                    </MudTd>

                                                                                    <MudTd DataLabel="@Localizer["path"]" @onclick="() => Applications_Drivers_History_RowClickHandler(applications_drivers_history_row)" class="@Applications_Drivers_History_GetRowClass(applications_drivers_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@applications_drivers_history_row.path
                                                                                        </span>
                                                                                    </MudTd>
                                                                                    <MudTd DataLabel="Version" @onclick="() => Applications_Drivers_History_RowClickHandler(applications_drivers_history_row)" class="@Applications_Drivers_History_GetRowClass(applications_drivers_history_row)" style="white-space: nowrap;">
                                                                                        <span style="display: flex; align-items: center;">
                                                                                            &nbsp;@applications_drivers_history_row.version
                                                                                        </span>
                                                                                    </MudTd>

                                                                                </RowTemplate>
                                                                                <PagerContent>
                                                                                    <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                                                </PagerContent>
                                                                            </MudTable>
                                                                    </ChildContent>
                                                                </MudExpansionPanel>
                                                            </MudTabPanel>
                                        }

                                    </MudTabs>
                                </MudTabPanel>
                            }
                                
                            @if (permissions_devices_task_manager)
                            {
                                <MudTabPanel Text="Task Manager">
                                    <MudPaper>

                                        <MudButton Class="ml-2 mt-2" Size="Size.Small" Color="Color.Default" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Warning" @onclick="@(() => Remote_Task_Manager_Action(task_manager_selectedRowContent))" Disabled="@(String.IsNullOrEmpty(task_manager_selectedRowContent))">@Localizer["terminate"]</MudButton>

                                        <MudTooltip Text="@Localizer["export_data"]">
                                            <MudIconButton Class="ml-2 mt-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Task_Manager_Table_Dialog"></MudIconButton>
                                        </MudTooltip>

                                        <MudTable Class="mt-0" Height="60vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@task_manager_mysql_data" Filter="new Func<Task_Manager_Entity, bool>(Task_Manager_Table_Filter_Func)">
                                            <ToolBarContent>
                                                <MudTextField @bind-Value="task_manager_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                            </ToolBarContent>
                                            <HeaderContent>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.name)">Name</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.pid)">PID</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.parent_name)">@Localizer["parent_name"]</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.parent_pid)">Parent PID</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.cpu)">CPU (%)</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.ram)">RAM (MB)</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.user)">@Localizer["user"]</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.created)">@Localizer["created"]</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.path)">@Localizer["path"]</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.cmd)">Commandline</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.handles)">Handles</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.threads)">Threads</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.read_operations)">@Localizer["read_operations"]</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.read_transfer)">@Localizer["read_transfer"]</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.write_operations)">@Localizer["write_operations"]</MudTableSortLabel></MudTh>
                                                <MudTh Style="white-space: nowrap;"><MudTableSortLabel SortBy="new Func<Task_Manager_Entity, object>(x => x.write_transfer)">@Localizer["write_transfer"]</MudTableSortLabel></MudTh>
                                            </HeaderContent>

                                            <RowTemplate Context="task_manager_row">

                                                <MudTd DataLabel="Name" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.name
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="PID" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.pid
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="@Localizer["parent_name"]" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.parent_name
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="Parent PID" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.parent_pid
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="CPU (%)" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.cpu
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="RAM (MB)" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.ram
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="@Localizer["user"]" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.user
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="@Localizer["created"]" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.created
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="@Localizer["path"]" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.path
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="Commandline" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.cmd
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="Handles" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.handles
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="Threads" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.threads
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="@Localizer["read_operations"]" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.read_operations
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="@Localizer["read_transfer"]" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.read_transfer
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="@Localizer["write_operations"]" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.write_operations
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="@Localizer["write_transfer"]" @onclick="() => Task_Manager_RowClickHandler(task_manager_row)" class="@Task_Manager_GetRowClass(task_manager_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@task_manager_row.write_transfer
                                                    </span>
                                                </MudTd>

                                            </RowTemplate>
                                            <PagerContent>
                                                <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                            </PagerContent>
                                        </MudTable>

                                    </MudPaper>

                                    <MudExpansionPanel Class="mt-5 custom-expansion-panel" @bind-Expanded="device_information_task_manager_history_expanded" @bind-Expanded:after="async () => { await Device_Information_Task_Manager_History_Table_Submit_Picker(); }" >
                                        <TitleContent>
                                            <div class="d-flex">
                                                <MudIcon Icon="@Icons.Material.Filled.History" class="mr-3"></MudIcon>
                                                <MudText>@Localizer["history"]</MudText>
                                            </div>
                                        </TitleContent>

                                        <ChildContent>

                                            <div style="display: flex; align-items: center;">
                                                <MudDateRangePicker PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="device_information_task_manager_history_table_picker" @bind-DateRange="device_information_task_manager_history_table_dateRange">
                                                    <PickerActions Context="pickerActionsContext">
                                                        <MudButton Class="mr-auto align-self-start" OnClick="@(() => device_information_task_manager_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                        <MudButton OnClick="@(() => device_information_task_manager_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                        <MudButton Color="Color.Primary" @onclick="async () => { await Device_Information_Task_Manager_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                    </PickerActions>
                                                </MudDateRangePicker>

                                                <MudTooltip Text="@Localizer["export_data"]">
                                                    <MudIconButton Class="ml-2 mt-5" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default"  @onclick="Export_Task_Manager_History_Table_Dialog"></MudIconButton>
                                                </MudTooltip>
                                            </div>

                                            <MudTable Class="mt-2" Height="25vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="int.MaxValue" Dense="true" Items="@task_manager_history_mysql_data" GroupBy="@task_manager_history_groupDefinition" Filter="new Func<Task_Manager_History_Entity, bool>(Task_Manager_History_Table_Filter_Func)">
                                                <ToolBarContent>
                                                    <MudTextField Class="mt-0" @bind-Value="task_manager_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                </ToolBarContent>
                                                <HeaderContent>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.date))" style="white-space: nowrap;">@Localizer["date"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.name))" style="white-space: nowrap;">Name</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.pid))" style="white-space: nowrap;">PID</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.parent_name))" style="white-space: nowrap;">@Localizer["parent_name"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.parent_pid))" style="white-space: nowrap;">Parent PID</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.cpu))" style="white-space: nowrap;">CPU (%)</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.ram))" style="white-space: nowrap;">RAM (MB)</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.user))" style="white-space: nowrap;">@Localizer["user"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.created))" style="white-space: nowrap;">@Localizer["created"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.path))" style="white-space: nowrap;">@Localizer["path"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.cmd))" style="white-space: nowrap;">Commandline</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.handles))" style="white-space: nowrap;">Handles</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.threads))" style="white-space: nowrap;">Threads</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.read_operations))" style="white-space: nowrap;">@Localizer["read_operations"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.read_transfer))" style="white-space: nowrap;">@Localizer["read_transfer"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.write_operations))" style="white-space: nowrap;">@Localizer["write_operations"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => task_manager_history_table_sorted_column = (nameof(Task_Manager_History_Entity.write_transfer))" style="white-space: nowrap;">@Localizer["write_transfer"]</MudTh>
                                                </HeaderContent>
                                                <GroupHeaderTemplate Context="groupContext">
                                                    <MudTh Class="mud-table-cell-custom-group" colspan="6">@($"{groupContext.GroupName}: {groupContext.Key}") </MudTh>
                                                </GroupHeaderTemplate>
                                                <RowTemplate Context="task_manager_history_row">

                                                    <MudTd DataLabel="@Localizer["date"]" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.date
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="Name" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.name
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="PID" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.pid
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["parent_name"]" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.parent_name
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="Parent PID" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.parent_pid
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="CPU (%)" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.cpu
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="RAM (MB)" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.ram
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["user"]" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.user
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["created"]" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.created
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["path"]" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.path
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="Commandline" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.cmd
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="Handles" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.handles
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="Threads" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.threads
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["read_operations"]" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.read_operations
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["read_transfer"]" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.read_transfer
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["write_operations"]" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.write_operations
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["write_transfer"]" @onclick="() => Task_Manager_History_RowClickHandler(task_manager_history_row)" class="@Task_Manager_History_GetRowClass(task_manager_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@task_manager_history_row.write_transfer
                                                        </span>
                                                    </MudTd>

                                                </RowTemplate>
                                                <PagerContent>
                                                    <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                </PagerContent>
                                            </MudTable>
     
                                        </ChildContent>
                                    </MudExpansionPanel>
                                </MudTabPanel>
                            }

                            @if (permissions_devices_antivirus && platform == "Windows" && antivirus_solution == "Windows Defender")
                            {
                                <MudTabPanel Text="Antivirus">
                            
                                    <MudPaper>

                                        <MudText Class="ml-2" Typo="Typo.h6">Antimalware</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Info" Color="@(antivirus_information_amserviceenabled ? Color.Success : Color.Error)" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_amserviceenabled"]: @antivirus_information_amserviceenabled_display</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Update" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_amengineversion"]: @antivirus_information_amengineversion</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Update" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_amproductversion"]: @antivirus_information_amproductversion</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Update" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_amserviceversion"]: @antivirus_information_amserviceversion</MudText>

                                        <MudText Class="mt-5 ml-2" Typo="Typo.h6">Antispyware</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Info" Color="@(antivirus_information_antispywareenabled ? Color.Success : Color.Error)" Title="Status" Size="Size.Small" />&nbsp;Status: @antivirus_information_antispywareenabled_display</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.AccessTime" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_antispywaresignaturelastupdated"]: @antivirus_information_antispywaresignaturelastupdated</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Update" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_antispywaresignatureversion"]: @antivirus_information_antispywaresignatureversion</MudText>

                                        <MudText Class="mt-5 ml-2" Typo="Typo.h6">Antivirus</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Info" Color="@(antivirus_information_antivirusenabled ? Color.Success : Color.Error)" Title="Status" Size="Size.Small" />&nbsp;Status: @antivirus_information_antivirusenabled_display</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Update" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_antivirussignaturelastupdated"]: @antivirus_information_antivirussignaturelastupdated</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.AccessTime" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_antivirussignatureversion"]: @antivirus_information_antivirussignatureversion</MudText>

                                        <MudText Class="mt-5 ml-2" Typo="Typo.h6">@Localizer["antivirus_information_nis"]</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Info" Color="@(antivirus_information_nisenabled ? Color.Success : Color.Error)" Title="Status" Size="Size.Small" />&nbsp;Status: @antivirus_information_nisenabled_display</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Update" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_nisengineversion"]: @antivirus_information_nisengineversion</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.AccessTime" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_nissignaturelastupdated"]: @antivirus_information_nissignaturelastupdated</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Update" Title="Status" Size="Size.Small" />&nbsp;@Localizer["antivirus_information_nissignatureversion"]: @antivirus_information_nissignatureversion</MudText>
                                
                                        <MudText Class="mt-5 ml-2" Typo="Typo.h6">@Localizer["real_time_protection"]</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Info" Title="Status" Color="@(antivirus_information_realtimetprotectionenabled ? Color.Success : Color.Error)" Size="Size.Small" />&nbsp;Status: @antivirus_information_realtimetprotectionenabled_display</MudText>

                                        <MudText Class="mt-5 ml-2" Typo="Typo.h6">@Localizer["on_access_protection"]</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Info" Title="Status" Color="@(antivirus_information_onaccessprotectionenabled ? Color.Success : Color.Error)" Size="Size.Small" />&nbsp;Status: @antivirus_information_onaccessprotectionenabled_display</MudText>

                                        <MudText Class="mt-5 ml-2" Typo="Typo.h6">@Localizer["behavior_monitoring"]</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Info" Title="Status" Color="@(antivirus_information_behaviormonitorenabled ? Color.Success : Color.Error)" Size="Size.Small" />&nbsp;Status: @antivirus_information_behaviormonitorenabled_display</MudText>

                                        <MudText Class="mt-5 ml-2" Typo="Typo.h6">@Localizer["ioav"]</MudText>
                                        <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Info" Title="Status" Color="@(antivirus_information_ioavprotectionenabled ? Color.Success : Color.Error)" Size="Size.Small" />&nbsp;Status: @antivirus_information_ioavprotectionenabled_display</MudText>

                                        <MudText Class="mt-5 ml-2" Typo="Typo.h6">@Localizer["tamper_protection"]</MudText>
                                            <MudText Class="ml-2 d-flex align-center" Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Info" Title="Status" Color="@(antivirus_information_istamperprotected ? Color.Success : Color.Error)" Size="Size.Small" />&nbsp;Status: @antivirus_information_istamperprotected_display</MudText>
                                
                                    </MudPaper>

                                </MudTabPanel>
                            }

                            @if (permissions_devices_remote_shell)
                            {
                                <MudTabPanel Text="Remote">
                            
                                    <MudTabs KeepPanelsAlive=true Elevation="4" Rounded="false" Color="@Color.Default">
                                        <MudTabPanel Text="@Localizer["remote_shell_history"]">

                                        <MudPaper>

                                            <div style="display: flex; align-items: center;">
                                                <MudDateRangePicker Class="ml-2" PickerVariant="PickerVariant.Dialog" Label="@Localizer["time_span"]" @ref="device_information_remote_shell_history_table_picker" @bind-DateRange="device_information_remote_shell_history_table_dateRange" >
                                                    <PickerActions Context="pickerActionsContext">
                                                        <MudButton Class="mr-auto align-self-start" OnClick="@(() => device_information_remote_shell_history_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                        <MudButton OnClick="@(() => device_information_remote_shell_history_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                        <MudButton Color="Color.Primary" @onclick="async () => { await Device_Information_Remote_Shell_History_Table_Submit_Picker(); }">@Localizer["confirm"]</MudButton>
                                                    </PickerActions>
                                                </MudDateRangePicker>

                                                <MudTooltip Text="@Localizer["export_data"]">
                                                    <MudIconButton Class="ml-2 mt-5 ml-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Trigger_Export_Remote_Shell_History_Table_Dialog"></MudIconButton>
                                                </MudTooltip>
                                            </div>

                                            <MudTable Class="mt-5" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" RowsPerPage="25" Dense="true" Items="@device_information_remote_shell_history_mysql_data" Filter="new Func<Device_Information_Remote_Shell_History_Entity, bool>(Device_Information_Remote_Shell_History_Table_Filter_Func)">
                                                <ToolBarContent>
                                                    <MudTextField @bind-Value="device_information_remote_shell_history_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
                                                </ToolBarContent>
                                                <HeaderContent>
                                                    <MudTh Sortable="true" @onclick="() => device_information_remote_shell_history_table_sorted_column = (nameof(Device_Information_Remote_Shell_History_Entity.date))" style="white-space: nowrap;">@Localizer["date"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => device_information_remote_shell_history_table_sorted_column = (nameof(Device_Information_Remote_Shell_History_Entity.author))" style="white-space: nowrap;">@Localizer["author"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => device_information_remote_shell_history_table_sorted_column = (nameof(Device_Information_Remote_Shell_History_Entity.command))" style="white-space: nowrap;">@Localizer["command"]</MudTh>
                                                    <MudTh Sortable="true" @onclick="() => device_information_remote_shell_history_table_sorted_column = (nameof(Device_Information_Remote_Shell_History_Entity.result))" style="white-space: nowrap;">@Localizer["result"]</MudTh>
                                                </HeaderContent>
                                                <RowTemplate Context="device_information_remote_shell_history_row">

                                                    <MudTd DataLabel="@Localizer["date"]" @onclick="() => Device_Information_Remote_Shell_History_RowClickHandler(device_information_remote_shell_history_row)" class="@Device_Information_Remote_Shell_History_GetRowClass(device_information_remote_shell_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@device_information_remote_shell_history_row.date
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["author"]" @onclick="() => Device_Information_Remote_Shell_History_RowClickHandler(device_information_remote_shell_history_row)" class="@Device_Information_Remote_Shell_History_GetRowClass(device_information_remote_shell_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@device_information_remote_shell_history_row.author
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["command"]" @onclick="() => Device_Information_Remote_Shell_History_RowClickHandler(device_information_remote_shell_history_row)" class="@Device_Information_Remote_Shell_History_GetRowClass(device_information_remote_shell_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@device_information_remote_shell_history_row.command
                                                        </span>
                                                    </MudTd>

                                                    <MudTd DataLabel="@Localizer["result"]" @onclick="() => Device_Information_Remote_Shell_History_RowClickHandler(device_information_remote_shell_history_row)" class="@Device_Information_Remote_Shell_History_GetRowClass(device_information_remote_shell_history_row)" style="white-space: nowrap;">
                                                        <span style="display: flex; align-items: center;">
                                                            &nbsp;@device_information_remote_shell_history_row.result
                                                        </span>
                                                    </MudTd>

                                                </RowTemplate>
                                                <PagerContent>
                                                    <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                </PagerContent>
                                            </MudTable>

                                        </MudPaper>

                                        </MudTabPanel>

                                    </MudTabs>

                                </MudTabPanel>
                            }

                            @if (permissions_devices_events)
                            {
                                    <MudTabPanel Text="@Localizer["events"]">
                                        <MudPaper>

                                            <div style="display: flex; align-items: center;">
                                                <MudDateRangePicker Class="ml-2" PickerVariant="PickerVariant.Dialog" Label="Zeitraum" @ref="device_information_events_table_picker" @bind-DateRange="device_information_events_table_dateRange" @bind-DateRange:after="async () => { events_mysql_data = await Events_Load(notes_device_id, true); }">
                                                    <PickerActions Context="pickerActionsContext">
                                                        <MudButton Class="mr-auto align-self-start" OnClick="@(() => device_information_events_table_picker.ClearAsync())">@Localizer["reset"]</MudButton>
                                                        <MudButton OnClick="@(() => device_information_events_table_picker.CloseAsync(false))">@Localizer["cancel"]</MudButton>
                                                        <MudButton Color="Color.Primary" @onclick="async () => { await Device_Information_Events_Table_Submit(); }">@Localizer["confirm"]</MudButton>
                                                    </PickerActions>
                                                </MudDateRangePicker>

                                                <MudTooltip Text="@Localizer["refresh"]">
                                                    <MudIconButton Class="ml-2 mt-5 mr-2" Icon="@Icons.Material.Filled.Refresh" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="async () => { events_mysql_data = await Events_Load(notes_device_id, true); }"></MudIconButton>
                                                </MudTooltip>
                                                <MudTooltip Text="@Localizer["mark_as_read"]">
                                                    <MudIconButton Class="ml-2 mt-5 mr-2" Icon="@Icons.Material.Filled.MarkChatRead" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="@(async () => { await Classes.MySQL.Handler.Execute_Command("UPDATE `events` SET `read` = 1;"); events_mysql_data = await Events_Load(notes_device_id, true);})"></MudIconButton>
                                                </MudTooltip>
                                                <MudTooltip Text="@Localizer["export_data"]">
                                                    <MudIconButton Class="ml-2 mt-5 mr-2" Icon="@Icons.Material.Filled.FileDownload" Variant="Variant.Filled" Size="Size.Small" Color="Color.Default" @onclick="Export_Events_Table_Dialog"></MudIconButton>
                                                </MudTooltip>
                                            </div>

                                            <div style="display: flex; align-items: center;">

                                                <MudSelect Class="ml-2 mt-3 mr-2" T="string" @bind-Value="device_information_events_severity_string" @bind-Value:after="async () => { events_mysql_data = await Events_Load(notes_device_id, true); }" Label="@Localizer["severity"]" AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.TopCenter">
                                                    <MudSelectItem T="string" Value="@Localizer["any"]" />
                                                    <MudSelectItem T="string" Value="@Localizer["critical"]" />
                                                    <MudSelectItem T="string " Value="@Localizer["high"]" />
                                                    <MudSelectItem T="string" Value="@Localizer["moderate"]" />
                                                    <MudSelectItem T="string" Value="@Localizer["low"]" />
                                                </MudSelect>

                                                <MudSelect Class="ml-2 mt-3 mr-2" T="string" @bind-Value="events_type_string" @bind-Value:after="async () => { events_mysql_data = await Events_Load(notes_device_id, true); }" Label="@Localizer["type"]" AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.TopCenter">
                                                    <MudSelectItem T="string" Value="@Localizer["any"]" />
                                                    <MudSelectItem T="string" Value="@Localizer["antivirus"]" />
                                                    <MudSelectItem T="string " Value="@Localizer["job"]" />
                                                    <MudSelectItem T="string" Value="@Localizer["sensor"]" />
                                                </MudSelect>

                                            </div>

                                            <MudTable Class="mt-2" Height="50vh" FixedHeader="true" FixedFooter="true" Hover="true" @bind-RowsPerPage="events_rows_per_page" Dense="true" Items="@events_mysql_data" Filter="new Func<Events_Table, bool>(Events_Table_Filter_Func)">
                                                <ToolBarContent>
                                                    <MudTextField Class="mt-0" @bind-Value="events_table_search_string" Placeholder="@Localizer["search"]" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"></MudTextField>
                                                </ToolBarContent>
                                                <HeaderContent>
                                                    <MudTh><MudTableSortLabel SortBy="new Func<Events_Table, object>(x => x.severity)">@Localizer["severity"]</MudTableSortLabel></MudTh>
                                                    <MudTh><MudTableSortLabel SortBy="new Func<Events_Table, object>(x => x.date)">@Localizer["date"]</MudTableSortLabel></MudTh>
                                                    <MudTh><MudTableSortLabel SortBy="new Func<Events_Table, object>(x => x.reported_by)">@Localizer["reported_by"]</MudTableSortLabel></MudTh>
                                                    <MudTh><MudTableSortLabel SortBy="new Func<Events_Table, object>(x => x._event)">@Localizer["event"]</MudTableSortLabel></MudTh>
                                                </HeaderContent>

                                                <RowTemplate Context="events_row">

                                                    <MudTd DataLabel="@Localizer["severity"]" @onclick="() => Events_RowClickHandler(events_row)" class="@Events_GetRowClass(events_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                    @{
                                                        if (events_row.severity == "0")
                                                        {
                                                            <MudChip T="string" Color="Color.Default">@Localizer["low"]</MudChip>
                                                        }
                                                        else if (events_row.severity == "1")
                                                        {
                                                            <MudChip T="string" Color="Color.Info">@Localizer["moderate"]</MudChip>
                                                        }
                                                        else if (events_row.severity == "2")
                                                        {
                                                            <MudChip T="string" Color="Color.Warning">@Localizer["high"]</MudChip>
                                                        }
                                                        else if (events_row.severity == "3")
                                                        {
                                                            <MudChip T="string" Color="Color.Error">@Localizer["critical"]</MudChip>
                                                        }
                                                    }
                                                    </span>
                                                </MudTd>
                            
                                                <MudTd DataLabel="@Localizer["date"]" @onclick="() => Events_RowClickHandler(events_row)" class="@Events_GetRowClass(events_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@events_row.date
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="@Localizer["reported_by"]" @onclick="() => Events_RowClickHandler(events_row)" class="@Events_GetRowClass(events_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@events_row.reported_by
                                                    </span>
                                                </MudTd>

                                                <MudTd DataLabel="Event" @onclick="() => Events_RowClickHandler(events_row)" class="@Events_GetRowClass(events_row)" style="white-space: nowrap;">
                                                    <span style="display: flex; align-items: center;">
                                                        &nbsp;@events_row._event
                                                    </span>
                                                </MudTd>

                                                </RowTemplate>
                                                <PagerContent>
                                                    <MudTablePager PageSizeOptions="new int[] { 10, 25, 50, 100, 250, 500, int.MaxValue }" RowsPerPageString="@Localizer["rows_per_page"]" />
                                                </PagerContent>
                                            </MudTable>

                                        </MudPaper>
                                    </MudTabPanel>
                            }

                            </MudTabs>

                        </ChildContent>


                    </MudExpansionPanel>
                }
            }
        }

    </Authorized>
</AuthorizeView>


